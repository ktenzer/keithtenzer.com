I"Ù<h2><img class="alignnone size-full wp-image-10161" src="/assets/2017/05/openstack-logo-2016.png" alt="openstack-logo-2016" width="770" height="211" /></h2>
<h2>Overview</h2>
<p>OpenStack Cinder is responsible for handling block storage in the context of OpenStack. Cinder provides a standard API and interface that allows storage companies to create their own drivers in order to integrate storage capabilities into OpenStack in a consistent way. Each storage pool exposed to OpenStack Cinder is a backend and you can have many storage backends. You can also have many of the same kind of storage backends. In this article we will look at two advanced features Cinder provides: types and the scheduler.</p>
<p>Cinder typesÂ essentially allow us to label Cinder storage backends. This allows forÂ building out storage services that have expected characteristics and capabilities. The Cinder driver exposesÂ those storage capabilities to Cinder.</p>
<p>The Cinder scheduler is responsible for deciding where to create Cinder volumes when we have more than one of the same kind of storage backend. This is done by looking at the filter rules in order to identify the most appropriate storage backend. More about filter rules can be found <a href="https://docs.openstack.org/developer/cinder/scheduler-filters.html">here</a>.</p>
<p><!--more--></p>
<h2>Prerequisites</h2>
<p>In order to follow along you will need an OpenStack environment. The easiest thing to do is setup an all-in-one environment with RDO. Those steps are documented <a href="https://keithtenzer.com/2017/03/27/openstack-10-newton-lab-installation-and-configuration-guide/">here</a>.</p>
<p>If you want to use Ceph and don't have an environment or things setup properly then you can follow below guides:</p>
<ul>
<li><a href="https://keithtenzer.com/2017/02/03/red-hat-ceph-storage-2-0-lab-object-storage-configuration-guide/">Ceph setup</a></li>
<li><a href="https://keithtenzer.com/2016/09/12/openstack-integrating-ceph-as-storage-backend/">Ceph OpenStack configuration</a></li>
</ul>
<h2>Configure Storage Backends</h2>
<p>[OpenStack Controller]</p>
<p><strong>Add two disks to OpenStack controller. </strong></p>
<p>For all-in-one setup this is straight-forward. If you have multiple controllers then it needs to be a controller running openstack-cinder-volume service.</p>
<p><strong>Create LVM Storage Backends.</strong></p>
<p>Authenticate to OpenStack using keystone source file.</p>
<pre># source /root/keystonerc_admin</pre>
<p>Determine appropriate block device names for newly added disks.Â The below commands can be useful. In this case the two disks are vdb and vdc.</p>
<pre># blkid
# lsblk</pre>
<p><strong>Create physical volumes and volume groups.</strong></p>
<pre># pvcreate /dev/vdb
# vgcreate lvm-1 /dev/vdb</pre>
<pre># pvcreate /dev/vdc
# vgcreate lvm-2 /dev/vdc</pre>
<p><strong>Update Cinder configuration and add LVM backends.</strong></p>
<pre># vi /etc/cinder/cinder.conf
default_volume_type = rbd
enabled_backends = lvm1,lvm2,rbd
</pre>
:ET