<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.22.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>OpenStack Tips and Tricks - KEITHTENZER.COM</title>
<meta name="description" content="Overview In this article we will look at some common OpenStack Kilo configuration optimizations and other tricks. This is by no means a comprehensive guide, just things I have stumbled across that if documented would have saved me time. I continue to update this blog with things I learned. If you have some valuable tips or tricks then let me know so I can add those?  Nested Virtualization Many run OpenStack on KVM for testing, learning, training or even demos. In order to get acceptable performance, the Hypervisor and guest must be configured to support Nested Virtualization. Ensure KVM is enabled #lsmod | grep -i kvm kvm_intel 148081 6  kvm 461126 1 kvm_intel #modinfo kvm_intel | grep -i nested parm: nested:bool">


  <meta name="author" content="Keith Tenzer">
  
  <meta property="article:author" content="Keith Tenzer">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="KEITHTENZER.COM">
<meta property="og:title" content="OpenStack Tips and Tricks">
<meta property="og:url" content="https://keithtenzer.com/openstack/openstack-tips-and-tricks/">


  <meta property="og:description" content="Overview In this article we will look at some common OpenStack Kilo configuration optimizations and other tricks. This is by no means a comprehensive guide, just things I have stumbled across that if documented would have saved me time. I continue to update this blog with things I learned. If you have some valuable tips or tricks then let me know so I can add those?  Nested Virtualization Many run OpenStack on KVM for testing, learning, training or even demos. In order to get acceptable performance, the Hypervisor and guest must be configured to support Nested Virtualization. Ensure KVM is enabled #lsmod | grep -i kvm kvm_intel 148081 6  kvm 461126 1 kvm_intel #modinfo kvm_intel | grep -i nested parm: nested:bool">





  <meta name="twitter:site" content="@keithtenzer">
  <meta name="twitter:title" content="OpenStack Tips and Tricks">
  <meta name="twitter:description" content="Overview In this article we will look at some common OpenStack Kilo configuration optimizations and other tricks. This is by no means a comprehensive guide, just things I have stumbled across that if documented would have saved me time. I continue to update this blog with things I learned. If you have some valuable tips or tricks then let me know so I can add those?  Nested Virtualization Many run OpenStack on KVM for testing, learning, training or even demos. In order to get acceptable performance, the Hypervisor and guest must be configured to support Nested Virtualization. Ensure KVM is enabled #lsmod | grep -i kvm kvm_intel 148081 6  kvm 461126 1 kvm_intel #modinfo kvm_intel | grep -i nested parm: nested:bool">
  <meta name="twitter:url" content="https://keithtenzer.com/openstack/openstack-tips-and-tricks/">

  
    <meta name="twitter:card" content="summary">
    
  

  



  <meta property="article:published_time" content="2015-09-25T00:00:00-07:00">





  

  


<link rel="canonical" href="https://keithtenzer.com/openstack/openstack-tips-and-tricks/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Keith Tenzer",
      "url": "https://keithtenzer.com/"
    
  }
</script>







<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="KEITHTENZER.COM Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->


    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          KEITHTENZER.COM
          <span class="site-subtitle">Cloud Computing and Code</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/about/index.html">About</a>
            </li><li class="masthead__menu-item">
              <a href="/conferences-and-events/index.html">Conferences and Events</a>
            </li><li class="masthead__menu-item">
              <a href="/videos/index.html">Videos</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      


  
    



<nav class="breadcrumbs">
  <ol itemscope itemtype="https://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="https://keithtenzer.com/" itemprop="item"><span itemprop="name">Home</span></a>
          <meta itemprop="position" content="1" />
        </li>
        <span class="sep">/</span>
      
      
        
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="/categories/#openstack" itemprop="item"><span itemprop="name">Openstack</span></a>
          <meta itemprop="position" content="2" />
        </li>
        <span class="sep">/</span>
      
    
      
      
        <li class="current">OpenStack Tips and Tricks</li>
      
    
  </ol>
</nav>

  


<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/assets/main/me.png" alt="Keith Tenzer" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Keith Tenzer</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>Principal Solutions Architect at Red Hat</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Los Angeles, CA</span>
        </li>
      

      
        
          
        
          
        
          
            <li><a href="https://twitter.com/keithtenzer" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
          
        
          
        
          
            <li><a href="https://github.com/ktenzer" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="OpenStack Tips and Tricks">
    <meta itemprop="description" content="OverviewIn this article we will look at some common OpenStack Kilo configuration optimizations and other tricks. This is by no means a comprehensive guide, just things I have stumbled across that if documented would have saved me time. I continue to update this blog with things I learned. If you have some valuable tips or tricks then let me know so I can add those?Nested VirtualizationMany run OpenStack on KVM for testing, learning, training or even demos. In order to get acceptable performance, the Hypervisor and guest must be configured to support Nested Virtualization.Ensure KVM is enabled#lsmod | grep -i kvmkvm_intel 148081 6 kvm 461126 1 kvm_intel#modinfo kvm_intel | grep -i nestedparm: nested:bool">
    <meta itemprop="datePublished" content="2015-09-25T00:00:00-07:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">OpenStack Tips and Tricks
</h1>
          

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2015-09-25T00:00:00-07:00">September 25, 2015</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          11 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
        <h3><a href="https://keithtenzer.files.wordpress.com/2015/09/tipsandtricks.jpg"><img class="alignnone size-medium wp-image-1272" src="/assets/2015/09/tipsandtricks.jpg?w=300" alt="tipsandtricks" width="300" height="136" /></a></h3>
<h3>Overview</h3>
<p>In this article we will look at some common OpenStack Kilo configuration optimizations and other tricks. This is by no means a comprehensive guide, just things I have stumbled across that if documented would have saved me time. I continue to update this blog with things I learned. If you have some valuable tips or tricks then let me know so I can add those?<br />
<!--more--></p>
<h3>Nested Virtualization</h3>
<p>Many run OpenStack on KVM for testing, learning, training or even demos. In order to get acceptable performance, the Hypervisor and guest must be configured to support Nested Virtualization.</p>
<p>Ensure KVM is enabled</p>
<pre style="padding-left:30px;">#lsmod | grep -i kvm
kvm_intel 148081 6 
kvm 461126 1 kvm_intel</pre>
<pre style="padding-left:30px;">#modinfo kvm_intel | grep -i nested
parm: nested:bool

</pre>
<p>Unload KVM kernel module</p>
<pre style="padding-left:30px;">#modprobe -r kvm_intel</pre>
<p>Enable nested virtualization in KVM hypervisor</p>
<pre style="padding-left:30px;">#modprobe kvm_intel nested=Yes</pre>
<p>Create a guest for running OpenStack and edit the configuration to enable VMX.</p>
<pre style="padding-left:30px;">#virsh edit osp7.lab.com</pre>
<pre style="padding-left:30px;"> &lt;cpu mode='custom' match='exact'&gt;
 &lt;model fallback='allow'&gt;SandyBridge&lt;/model&gt;
 &lt;feature policy='require' name='vmx'/&gt;
 &lt;/cpu&gt;</pre>
<p>Start guest and verify that nested virtualization support is enabled.</p>
<pre style="padding-left:30px;">#ps -ef |grep qemu-kvm |grep vmx
qemu 8557 1 29 09:04 ? 00:03:52 /usr/libexec/qemu-kvm -name osp7.lab.com -S -machine pc-i440fx-rhel7.0.0,accel=kvm,usb=off -cpu SandyBridge,+vmx</pre>
<p>Change Libvirt type to KVM in Nova.</p>
<pre style="padding-left:30px;">#vi /etc/nova/nova.conf</pre>
<pre style="padding-left:30px;">virt_type=kvm</pre>
<h3>Fixing OpenStack Inconsistencies</h3>
<p>Sometimes things just don't work as expected, that is life and software. In OpenStack sometimes objects in the database and the actual resource can be inconsistent. This means the resource exists in the database but not anywhere else. I have seen this happen with Cinder volumes when deleting Heat stacks for example. If this occurs, your last resort if the *force* delete commands fail is to go into database and remove resource. It goes with out saying that you need to use extreme caution, as you can cause data loss or even corruption within OpenStack.</p>
<h4>Delete Cinder Volume</h4>
<p>Sometimes it can take a really long time to delete cinder volumes. The default behavior is to zero blocks. You can change this by setting volume_clear=none in /etc/cinder/cinder.conf. If you want to determine why delete is taking so long you should see what processes are using the volume. For LVM backends you can follow these steps. First check lvdisplay to see if logical volume exists.</p>
<pre style="padding-left:30px;"># lvdisplay</pre>
<pre style="padding-left:30px;">Get the major and minor number for volume.
# dmsetup info -c
Name Maj Min Stat Open Targ Event UUID
rhel-swap <strong>253 0</strong> L--w 2 1 0 LVM-I057BifDXT5pFxJ69IQuaLXouyIN6DDbltQCdDpuXeoSi3tFgBpYFQiETsCKO3CG
rhel-root <strong>253 1</strong> L--w 1 1 0 LVM-I057BifDXT5pFxJ69IQuaLXouyIN6DDbSP3WbTBmapCefb1mQLbdSzqw8drUculQ
cinder--volumes-volume--a052879b--9bbd--4285--8557--7c16337560c5 <strong>253 2</strong> L--w 1 1 0 LVM-nnajQLl8dA7KqOsFJgYajjFVQrkM0wjfcB9fNeV0PL1R9TuuJIX3dNHqYbfmBvL7

</pre>
<p>Using lsof check processes running on volumes</p>
<pre style="padding-left:30px;"># lsof | grep "<strong>253,2</strong>"
dd 5526 root 1w BLK 253,2 0x35f600000 15042 /dev/dm-2</pre>
<p>If processes are running (in this case dd), kill them and remove volume using lvremove. Once this is complete set volume status to available in cinder.</p>
<pre style="padding-left:30px;"> cinder reset-state --state available &lt;volume id&gt;</pre>
<p>Finally try deleting the volume. If all else fails you can go into database as last resort and delete things there.</p>
<pre style="padding-left:30px;"><code>#mysql cinder
</code><code>&gt; update volumes set deleted=1,status='deleted',deleted_at=now(),updated_at=now() where deleted=0 and id='$volume_uuid';</code></pre>
<h4>Detach a Volume from Cinder</h4>
<pre style="padding-left:30px;"><code>#mysql nova
&gt; delete from block_device_mapping where not deleted and volume_id='$volume_uuid' and project_id='$project_uuid';</code></pre>
<h4>Delete an Instance</h4>
<pre style="padding-left:30px;"><code>#mysql nova_db
&gt; update instances set deleted='1', vm_state='deleted', deleted_at='now()'' where uuid='$vm_uuid' and project_id='$project_uuid';</code></pre>
<h4>Change provision state of Ironic nodes</h4>
<pre style="padding-left:30px;"># mysql ironic</pre>
<pre style="padding-left:30px;">&gt; UPDATE nodes SET provision_state="available", target_provision_state=NULL, reservation=NULL WHERE uuid=&lt;uuid&gt;;</pre>
<h4>Delete Ironic nodes</h4>
<pre style="padding-left:30px;"># mysql ironic</pre>
<pre style="padding-left:30px;">&gt; delete from ports where uuid="0867df16-82c9-4358-9bc9-a36933c361e1";</pre>
<pre style="padding-left:30px;">&gt; delete from nodes where uuid="92b6477c-d556-4958-9950-5c11ca57e459";</pre>
<h3>Fixing Horizon Re-login issue</h3>
<p>There is an issue in OpenStack Kilo with re-login because of bad cookie session. Here is how to fix the issue.</p>
<pre style="padding-left:30px;">#vi /etc/openstack-dashboard/local_settings</pre>
<pre class="prettyprint" style="padding-left:30px;"><code><span class="pln">AUTH_USER_MODEL </span><span class="pun">=</span> <span class="str">'openstack_auth.User'</span></code></pre>
<h3>Heat Topology Images Broken</h3>
<pre class="highlight plaintext"><code>service openstack-cinder-volume restart</code></pre>
<p>There is an issue in OpenStack Kilo with the Heat topology images being broken. Here is how to fix it.</p>
<pre style="padding-left:30px;">#vi /etc/httpd/conf.d/openstack-dashboard.conf</pre>
<pre style="padding-left:30px;">Alias /static/dashboard /usr/share/openstack-dashboard/static/dashboard</pre>
<pre style="padding-left:30px;">systemctl restart httpd</pre>
<h3>Adding Cinder Volume for LVM backend</h3>
<p>By default RDO will use a loopback device for the Cinder LVM backend. In order to change this you can follow the procedure below assuming disk is called /dev/vdb1.</p>
<pre style="padding-left:30px;">#<code>openstack-config --set /etc/cinder/cinder.conf DEFAULT lvm_type thin</code></pre>
<pre style="padding-left:30px;">#systemctl restart <code>openstack-cinder-volume</code></pre>
<pre style="padding-left:30px;">#fdisk /dev/vdb1</pre>
<pre style="padding-left:30px;">#fdisk /dev/vdb1</pre>
<pre style="padding-left:30px;">#pvcreate /dev/vdb1</pre>
<pre style="padding-left:30px;">#vgcreate cinder_storage /dev/vdb1</pre>
<pre style="padding-left:30px;">#vgcreate cinder_storage /dev/vdb1</pre>
<pre style="padding-left:30px;">#vi /etc/cinder/cinder.conf</pre>
<pre style="padding-left:30px;">[lvm]
volume_group=my_new_cinder_storage
volume_driver=cinder.volume.drivers.lvm.LVMVolumeDriver</pre>
<h3>Force Deleting Keystone Endpoints</h3>
<pre># mysql keystone</pre>
<pre>MariaDB [keystone]&gt; delete from endpoint where id="07d77cefad0049b1ae5e1eb6692ebfa1";</pre>
<h3>Adding NFS as Cinder Backend</h3>
<p>Cinder can use many different backends and using an NFS backend provides a lot of flexibility in addition to removing compülexity with ISCSI/LVM.</p>
<p>If SELinux is enabled allow NFS access</p>
<pre class="screen" style="padding-left:30px;"><code>setsebool -P virt_use_nfs on</code></pre>
<p>Create map file to make Cinder aware of NFS shares</p>
<pre style="padding-left:30px;">#vi /etc/cinder/nfs_share
192.168.0.22:/usr/share/openstack</pre>
<pre class="screen" style="padding-left:30px;"><code>chown root:cinder /etc/cinder/nfs_share</code></pre>
<pre class="screen" style="padding-left:30px;"><code>chmod 0640 /etc/cinder/nfs_share</code></pre>
<p>Configure NFS backend in Cinder</p>
<pre class="screen" style="padding-left:30px;"><code>openstack-config --set /etc/cinder/cinder.conf nfs nfs_shares_config /etc/cinder/nfs_share</code></pre>
<pre class="screen" style="padding-left:30px;"><code>openstack-config --set /etc/cinder/cinder.conf nfs volume_driver cinder.volume.drivers.nfs.NfsDriver</code></pre>
<pre class="screen" style="padding-left:30px;"><code>openstack-config --set /etc/cinder/cinder.conf nfs volume_backend_name nfsbackend</code></pre>
<p>Optionally you can add any required mount options</p>
<pre class="screen" style="padding-left:30px;"><code>openstack-config --set /etc/cinder/cinder.conf nfs nfs_mount_options <em class="replaceable">MOUNTOPTIONS</em></code></pre>
<pre style="padding-left:30px;"># vi /etc/cinder/cinder.conf
enabled_backends = lvm, nfs</pre>
<p>Restart Cinder volume service</p>
<pre class="screen" style="padding-left:30px;"><code>openstack-service restart cinder-volume</code></pre>
<p>Configure NFS volume type so that is uses the correct backend in Cinder</p>
<pre class="screen" style="padding-left:30px;"><code>cinder type-create nfstype </code></pre>
<pre class="screen" style="padding-left:30px;"><code>cinder type-key nfstype set volume_backend_name=nfsbackend</code></pre>
<h3>Configuring RHEV for OpenStack</h3>
<p>If you are using RHEV or any virtualization platform under OpenStack then you need to enable nested virtualization and ensure MAC Address Spoofing filters are disabled. Otherwise since OpenStack instance MAC address differs from that of the virtual machine packets will be dropped.</p>
<p>On RHEV-M</p>
<pre style="padding-left:30px;">#engine-config -s "UserDefinedVMProperties=macspoof=(true|false)"<code>
#service ovirt-engine restart</code></pre>
<p>Edit VM and enable macspoof by setting parameter to 'true'</p>
<p><img class="alignnone size-full wp-image-1869" src="/assets/2015/09/screenshot-from-2016-04-08-132234.png" alt="Screenshot from 2016-04-08 13:22:34" width="751" height="568" /></p>
<p>On Hypervisor Hosts</p>
<pre style="padding-left:30px;">#yum install -y vdsm-hook-macspoof</pre>
<pre style="padding-left:30px;">#wget http://mirrors.ibiblio.org/ovirt/pub/ovirt-3.5/rpm/el7/noarch/vdsm-hook-nestedvt-4.16.30-0.el7.centos.noarch.rpm</pre>
<pre style="padding-left:30px;">#rpm -Uvh vdsm-hook-nestedvt-4.16.30-0.el7.centos.noarch.rpm</pre>
<pre style="padding-left:30px;">#systemctl reboot</pre>
<p>On OpenStack Instance check to ensure nested virtualization active</p>
<pre style="padding-left:30px;">#egrep 'svm|vmx' /proc/pcuinfo</pre>
<h3>Remove Packstack (RDO)</h3>
<p>If you want to upgrade or change OpenStack deployment and you are using RDO it may be necessary to remove the installation to start cleanly. The below process can be used to accomplish that.</p>
<p>Delete any VMs that may be running or configured</p>
<pre class="programlisting language-bash hljs" style="padding-left:30px;"><span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> $(virsh list --all | grep instance- | awk <span class="hljs-string">'{print $2}'</span>) ; <span class="hljs-keyword">do</span>
    virsh destroy <span class="hljs-variable">$x</span> ;
    virsh undefine <span class="hljs-variable">$x</span> ;
<span class="hljs-keyword">done</span> ;</pre>
<p>Reconfigure network interfaces</p>
<p>Hopefully you saved your original network configuration. You need to replace /etc/sysconfig/network-scripts/ifcfg-* with your original configs or just set IP addresses on those interfaces.</p>
<pre style="padding-left:30px;">#cp /root/ifcfg-eth0 /etc/sysconfig/network-scripts</pre>
<pre style="padding-left:30px;">#rm /etc/sysconfig/network-scripts/ifcfg-br-ex</pre>
<p>Remove packages</p>
<pre class="programlisting language-bash hljs" style="padding-left:30px;">yum remove -y nrpe openvswitch <span class="hljs-string">"*nagios*"</span> puppet ntp ntp-perl ntpdate <span class="hljs-string">"*openstack*"</span> \
<span class="hljs-string">"*nova*"</span> <span class="hljs-string">"*keystone*"</span> <span class="hljs-string">"*glance*"</span> <span class="hljs-string">"*cinder*"</span> <span class="hljs-string">"*swift*"</span> \
mysql mysql-server httpd <span class="hljs-string">"*memcache*"</span> scsi-target-utils \
iscsi-initiator-utils perl-DBI perl-DBD-MySQL ;</pre>
<p>Ensure swift processes arent running</p>
<pre class="programlisting language-bash hljs" style="padding-left:30px;">ps -ef | grep -i repli | grep swift | awk <span class="hljs-string">'{print $2}'</span> | xargs <span class="hljs-built_in">kill</span> ;</pre>
<p>Remove configuration data. Note if you are using NFS backend you need to unmount it.</p>
<pre class="programlisting language-bash hljs" style="padding-left:30px;">rm -rf /etc/nagios /etc/yum.repos.d/packstack_* /root/.my.cnf \
/var/lib/mysql/ /var/lib/glance /var/lib/nova /etc/nova /etc/swift \
/srv/node/device*/* /var/lib/cinder/ /etc/rsync.d/frag* \
/var/cache/swift /var/<span class="hljs-built_in">log</span>/keystone ;</pre>
<p>Remove LVM volume</p>
<pre class="programlisting language-bash hljs" style="padding-left:30px;">vgremove <span class="hljs-_">-f</span> cinder-volumes ;</pre>
<p>Delete SSL certs</p>
<pre class="programlisting language-bash hljs" style="padding-left:30px;">find /etc/pki/tls -name <span class="hljs-string">"ssl_ps*"</span> | xargs rm -rf ;</pre>
<p>Unmount any leftover mounts</p>
<pre class="programlisting language-bash hljs" style="padding-left:30px;"><span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> $(df | grep <span class="hljs-string">"/lib/"</span> | sed <span class="hljs-_">-e</span> <span class="hljs-string">'s/.* //g'</span>) ; <span class="hljs-keyword">do</span>
    umount <span class="hljs-variable">$x</span> ;
<span class="hljs-keyword">done</span></pre>
<pre style="padding-left:30px;">#systemctl reboot</pre>
<h3>Summary</h3>
<p>This was a quick article focused on tips and tricks around OpenStack Kilo. I will continue to update this article with new tips and tricks. If you have anything you came across in OpenStack Kilo, please share.</p>
<p>Happy OpenStacking!</p>
<p>(c) 2015 Keith Tenzer</p>

        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/#kilo" class="page__taxonomy-item" rel="tag">Kilo</a><span class="sep">, </span>
    
      <a href="/tags/#kvm" class="page__taxonomy-item" rel="tag">KVM</a><span class="sep">, </span>
    
      <a href="/tags/#openstack" class="page__taxonomy-item" rel="tag">OpenStack</a><span class="sep">, </span>
    
      <a href="/tags/#rdo" class="page__taxonomy-item" rel="tag">RDO</a>
    
    </span>
  </p>




  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      <a href="/categories/#openstack" class="page__taxonomy-item" rel="tag">OpenStack</a>
    
    </span>
  </p>


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2015-09-25T00:00:00-07:00">September 25, 2015</time></p>


      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?via=keithtenzer&text=OpenStack+Tips+and+Tricks%20https%3A%2F%2Fkeithtenzer.com%2Fopenstack%2Fopenstack-tips-and-tricks%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fkeithtenzer.com%2Fopenstack%2Fopenstack-tips-and-tricks%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fkeithtenzer.com%2Fopenstack%2Fopenstack-tips-and-tricks%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/satellite/cloud-systems-management-satellite-6-1-getting-started-guide/" class="pagination--pager" title="Cloud Systems Management: Satellite 6.1 Getting Started Guide
">Previous</a>
    
    
      <a href="/openstack/auto-scaling-applications-with-openstack-heat/" class="pagination--pager" title="Auto Scaling Applications with OpenStack Heat
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You may also enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/openshift/openshift-service-mesh-getting-started-guide/" rel="permalink">OpenShift Service Mesh Getting Started Guide
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2021-04-27T00:00:00-07:00">April 27, 2021</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          11 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">






Overview
In this article we will explore the OpenShift Service Mesh and deploy a demo application to better understand the various concepts. First you...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/openshift/openshift-4-aws-ipi-installation-getting-started-guide/" rel="permalink">OpenShift 4 AWS IPI Installation Getting Started Guide
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2021-01-18T00:00:00-08:00">January 18, 2021</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          8 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">


Happy new year as this will be the first post of 2021! 2020 was obviously a challenging year, my hope is I will have more time to devote to blogging in 20...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/ansible/windows-automation-with-ansible-getting-started-guide/" rel="permalink">Windows Automation with Ansible: Getting Started Guide
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2020-05-19T00:00:00-07:00">May 19, 2020</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          14 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
Overview
In this article we will focus on how to get started with automation of windows using Ansible. Specifically we will look at installing 3rd party sof...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/general/red-hat-subscription-reporting-guide/" rel="permalink">Red Hat Subscription Reporting Guide
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2020-05-13T00:00:00-07:00">May 13, 2020</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          6 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
source: https://www.cio.com/article/3199910/zuora-blazes-a-new-trail-to-the-subscription-economy-and-a-post-erp-world.html
Overview
This article will look a...</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
          <li><a href="https://twitter.com/keithtenzer"" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
        
      
        
      
        
          <li><a href="https://github.com/ktenzer" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
      
        
      
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2021 Keith Tenzer. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>







  </body>
</html>
