<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.22.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
<link rel="icon" href="/assets/main/me.png">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Building Storage Services in OpenStack on NetApp - Part II of III - Keith Tenzer’s Blog</title>
<meta name="description" content="Welcome to part two of the three-part series on creating storage services in OpenStack on NetApp. In this post we will look at how to configure NetApp storage in a OpenStack environment. In part one of the series we looked at how to install and configure OpenStack. In part three we will look at how to configure storage services in OpenStack.  Building Storage Services in OpenStack on NetApp - Part I of III Building Storage Services in OpenStack on NetApp - Part III of III  Overview NetApp has the most unified storage combined with the best feature set in the industry. NetApp provides the only storage operating system which allows you to manage your data on-premise, off-premise, in private clouds, public clouds or even hybrid clouds. NetApp is a perfect fit for OpenStack as a storage platform. In this post we will explore why, discuss options and show you how to properly configure your NetApp storage system for OpenStack. Below is a diagram illustrating the broad-reaching data management capabilities of Data ONTAP:  Storage Considerations There are currently two OpenStack services which support storage: Cinder (block) and Swift (object). Manilla (file services) is an incubation project and slated for the kilo release later in 2015. For the purpose of this post I am going to focus on Cinder. E-Series vs FAS NetApp offers two product lines for storage the E-Series and FAS lines. I would not recommend choosing between E-Series or FAS as they have different uses in terms of OpenStack. E-Series is best used for Swift as a backend to object storage. It is very fast and has a great price to performance value. Swift is an object store and abstracts storage management. You want a fast, resilient, highly available storage system and that is the E-Series. The E-Series storage also has a nice feature called &quot;Dynamic Disk Pools&quot; which implements CRUSH (erasure coding) and it reduces storage footprint from 3x to just 1.25x for Swift in OpenStack environments. FAS is the clear choice when it comes to Cinder storage where you want data management features and capabilities exposed in OpenStack. ONTAP 7mode vs Clustered Data ONTAP In the FAS world there are also two choices. Personally I don&#39;t think it is much of a choice. Clustered Data ONTAP is the evolution of FAS storage. It is a scale-out architecture and scales in three dimensions: operations, performance and capacity. It is by far the most complete storage system ever built and certainly most capable storage system on the market today. Clustered Data ONTAP virtualizes storage into what are called Storage Virtual Machines (SVMs) which enable secure multi-tenancy. If we think about cloud computing platforms, multi-tenancy is the basis and a raw ingredient. Clustered Data ONTAP provides world-class data management, scalability in multiple dimensions, unified protocols (ISCSI, NFS, CIFS, and FC) and non-disruptive always-on operations in the same storage system. The only reason not to go with Clustered Data ONTAP is that you already have 7mode and don&#39;t have budget, otherwise it is no-brainer. NetApp of course supports 7mode with its OpenStack driver so this is an option for those that can&#39;t go with Clustered Data ONTAP. Storage Protocol There are two options for connecting storage to Cinder: ISCSI or NFS. At this time Fiber Chanel (FC) is not supported and if we consider cloud computing architectures, FC does not really have the horizontal scalability required. Let&#39;s face it we don&#39;t need a second segregated island for data traffic, IP networks are proven and scale, FC is simply out of this picture. Cinder exposes block devices to virtual machines or instances but it can reside on both NFS or ISCSI storage. I would recommend NFS as NFS storage is much easier to manage than ISCSI. However if you are a SAN only shop or coming from a SAN environment, ISCSI might be a nice way to bridge into OpenStack and not have to make changes to how hosts connect to their storage. You can even use a combination of both. You could use NFS for creating Cinder volumes where instances reside and ISCSI for host mount points. Again I would recommend NFS for everything and that is what I am going to cover but I wanted to at least explain both options. Configuring Clustered Data ONTAP We have made the following storage decisions for our OpenStack Cinder configuration:  FAS (storage platform) Clustered Data ONTAP (storage operating system) NFS (protocol)  Storage Virtual Machines Configure two storage virtual machines. One will be used to provide storage to Cinder volumes and the other for DR. At a minimum you will need two IPs for each SVM. One for the management LIF and the other the data LIF. Ensure that both SVMs data LIFs are reachable from the OpenStack host. Create SVMs   vserver create -vserver &lt;svm&gt; -subtype default -rootvolume &lt;rootvol&gt; -aggregate &lt;aggr&gt; -rootvolume-security-style unix   Create management LIFs   net int create -vserver &lt;svm&gt; -lif data -role data -data-protocol nfs -home-node steve-02 -home-port e0a -address &lt;ip&gt; -netmask &lt;netmask&gt; -firewall-policy mgmt   Create Data LIFs   net int create -vserver &lt;svm&gt; -lif data -role data -data-protocol nfs -home-node steve-02 -home-port e0a -address &lt;ip&gt; -netmask &lt;netmask&gt; -firewall-policy data   Ensure NFS services are running on both SVMs   nfs status -vserver   If NFS is not running you can start NFS as follows:   nfs on -vserver   nfs start -vserver   Create Export policy In order to export NetApp volumes to OpenStack via NFS we need an export policy. Create an export policy as follows:   export-policy create -vserver &lt;svm&gt; -policyname openstack     export-policy rule create -vserver &lt;svm&gt; -policyname openstack -clientmatch &lt;IP or CIDR&gt; -rorule any -rwrule any   Add export policy to SVM root volume otherwise OpenStack host wont have write permission   volume modify -vserver &lt;svm&gt; -volume &lt;rootvol&gt; -policy openstack   Create NetApp Volumes NetApp volumes are containers for storing files or LUNs. In the case of OpenStack a NetApp volume is a container for Cinder volumes which is a container for block devices. We will create three volumes for Cinder and each volume will define a different storage service e.g. gold, silver and bronze. In addition we will create a fourth volume for storing glance images. The beauty here is that the storage admin can define storage services based on containers and expose them up through Cinder for consumption in OpenStack. Clustered Data ONTAP allows us to mix SSDs and Spinning Disk in the same storage system to enable building services with different performance characteristics. One can create aggregates which contain NetApp volumes using SSDs, Spinning Disk or even a mix (hybrid aggregates). In addition Clustered Data ONTAP provides QoS at the IOP or bandwidth level which we can use to further define or even restrict our storage services. Gold Volume The gold volume will be our most expensive storage service but will have the best performance and availability. We will create a volume on the best performing aggregate and in addition mirror that volume to another SVM.   volume create -vserver &lt;svm&gt; -volume openstack_gold -aggregate &lt;aggr&gt; -size 500g -state online -type RW -policy openstack -snapshot-policy none -space-guarantee volume     volume mount -vserver &lt;svm&gt; -volume openstack_gold -junction-path /openstack_gold     snapmirror initialize -source-path &lt;svm&gt;:openstack_gold -destination-path &lt;svm dr&gt;:openstack_gold_dr   Silver Volume The silver volume will have a good price to performance but not include DR. We will create volume from a best performing aggregate and enable compression for space savings.   volume create -vserver &lt;svm&gt; -volume openstack_silver -aggregate &lt;aggr&gt; -size 500g -state online -type RW -policy openstack -snapshot-policy none -space-guarantee volume     volume mount -vserver &lt;svm&gt; -volume openstack_silver -junction-path /openstack_silver     volume efficiency on -vserver &lt;svm&gt; -volume openstack_silver     volume efficiency modify -vserver &lt;svm&gt; -volume openstack_silver -compression true -inline-compression true   Bronze Volume The bronze volume will have lower performing storage and be the most cost-effective service. We will create volume from lower performing aggregate and enable dedup for space savings. We will not enable DR.   volume create -vserver &lt;svm&gt; -volume openstack_bronze -aggregate &lt;aggr&gt; -size 500g -state online -type RW -policy openstack -snapshot-policy none -space-guarantee volume     volume mount -vserver &lt;svm&gt; -volume openstack_bronze -junction-path /openstack_bronze     volume efficiency on -vserver &lt;svm&gt; -volume openstack_bronze     volume efficiency policy create -vserver &lt;svm&gt; -policy bronze_dedupe -schedule  -duration - -enabled true   Glance Volume Finally we will create a volume for storing images in Glance. This volume does not have high performance requirements but we will certainly enable dedup to greatly reduce the storage footprint.   volume create -vserver &lt;svm&gt; -volume openstack_glance -aggregate &lt;aggr&gt; -size 500g -state online -type RW -policy openstack -snapshot-policy none -space-guarantee volume     volume mount -vserver &lt;svm&gt; -volume openstack_glance -junction-path /openstack_glance     volume efficiency on -vserver &lt;svm&gt; -volume openstack_bronze     volume efficiency policy create -vserver &lt;svm&gt; -policy bronze_dedupe -schedule  -duration - -enabled true   The next post in the series will cover configuring the above NetApp volumes in OpenStack as storage services. (c) 2014 Keith Tenzer">


  <meta name="author" content="Keith Tenzer">
  
  <meta property="article:author" content="Keith Tenzer">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Keith Tenzer's Blog">
<meta property="og:title" content="Building Storage Services in OpenStack on NetApp - Part II of III">
<meta property="og:url" content="http://localhost:4000/openstack/building-storage-services-in-openstack-on-netapp-part-ii-of-iii/">


  <meta property="og:description" content="Welcome to part two of the three-part series on creating storage services in OpenStack on NetApp. In this post we will look at how to configure NetApp storage in a OpenStack environment. In part one of the series we looked at how to install and configure OpenStack. In part three we will look at how to configure storage services in OpenStack.  Building Storage Services in OpenStack on NetApp - Part I of III Building Storage Services in OpenStack on NetApp - Part III of III  Overview NetApp has the most unified storage combined with the best feature set in the industry. NetApp provides the only storage operating system which allows you to manage your data on-premise, off-premise, in private clouds, public clouds or even hybrid clouds. NetApp is a perfect fit for OpenStack as a storage platform. In this post we will explore why, discuss options and show you how to properly configure your NetApp storage system for OpenStack. Below is a diagram illustrating the broad-reaching data management capabilities of Data ONTAP:  Storage Considerations There are currently two OpenStack services which support storage: Cinder (block) and Swift (object). Manilla (file services) is an incubation project and slated for the kilo release later in 2015. For the purpose of this post I am going to focus on Cinder. E-Series vs FAS NetApp offers two product lines for storage the E-Series and FAS lines. I would not recommend choosing between E-Series or FAS as they have different uses in terms of OpenStack. E-Series is best used for Swift as a backend to object storage. It is very fast and has a great price to performance value. Swift is an object store and abstracts storage management. You want a fast, resilient, highly available storage system and that is the E-Series. The E-Series storage also has a nice feature called &quot;Dynamic Disk Pools&quot; which implements CRUSH (erasure coding) and it reduces storage footprint from 3x to just 1.25x for Swift in OpenStack environments. FAS is the clear choice when it comes to Cinder storage where you want data management features and capabilities exposed in OpenStack. ONTAP 7mode vs Clustered Data ONTAP In the FAS world there are also two choices. Personally I don&#39;t think it is much of a choice. Clustered Data ONTAP is the evolution of FAS storage. It is a scale-out architecture and scales in three dimensions: operations, performance and capacity. It is by far the most complete storage system ever built and certainly most capable storage system on the market today. Clustered Data ONTAP virtualizes storage into what are called Storage Virtual Machines (SVMs) which enable secure multi-tenancy. If we think about cloud computing platforms, multi-tenancy is the basis and a raw ingredient. Clustered Data ONTAP provides world-class data management, scalability in multiple dimensions, unified protocols (ISCSI, NFS, CIFS, and FC) and non-disruptive always-on operations in the same storage system. The only reason not to go with Clustered Data ONTAP is that you already have 7mode and don&#39;t have budget, otherwise it is no-brainer. NetApp of course supports 7mode with its OpenStack driver so this is an option for those that can&#39;t go with Clustered Data ONTAP. Storage Protocol There are two options for connecting storage to Cinder: ISCSI or NFS. At this time Fiber Chanel (FC) is not supported and if we consider cloud computing architectures, FC does not really have the horizontal scalability required. Let&#39;s face it we don&#39;t need a second segregated island for data traffic, IP networks are proven and scale, FC is simply out of this picture. Cinder exposes block devices to virtual machines or instances but it can reside on both NFS or ISCSI storage. I would recommend NFS as NFS storage is much easier to manage than ISCSI. However if you are a SAN only shop or coming from a SAN environment, ISCSI might be a nice way to bridge into OpenStack and not have to make changes to how hosts connect to their storage. You can even use a combination of both. You could use NFS for creating Cinder volumes where instances reside and ISCSI for host mount points. Again I would recommend NFS for everything and that is what I am going to cover but I wanted to at least explain both options. Configuring Clustered Data ONTAP We have made the following storage decisions for our OpenStack Cinder configuration:  FAS (storage platform) Clustered Data ONTAP (storage operating system) NFS (protocol)  Storage Virtual Machines Configure two storage virtual machines. One will be used to provide storage to Cinder volumes and the other for DR. At a minimum you will need two IPs for each SVM. One for the management LIF and the other the data LIF. Ensure that both SVMs data LIFs are reachable from the OpenStack host. Create SVMs   vserver create -vserver &lt;svm&gt; -subtype default -rootvolume &lt;rootvol&gt; -aggregate &lt;aggr&gt; -rootvolume-security-style unix   Create management LIFs   net int create -vserver &lt;svm&gt; -lif data -role data -data-protocol nfs -home-node steve-02 -home-port e0a -address &lt;ip&gt; -netmask &lt;netmask&gt; -firewall-policy mgmt   Create Data LIFs   net int create -vserver &lt;svm&gt; -lif data -role data -data-protocol nfs -home-node steve-02 -home-port e0a -address &lt;ip&gt; -netmask &lt;netmask&gt; -firewall-policy data   Ensure NFS services are running on both SVMs   nfs status -vserver   If NFS is not running you can start NFS as follows:   nfs on -vserver   nfs start -vserver   Create Export policy In order to export NetApp volumes to OpenStack via NFS we need an export policy. Create an export policy as follows:   export-policy create -vserver &lt;svm&gt; -policyname openstack     export-policy rule create -vserver &lt;svm&gt; -policyname openstack -clientmatch &lt;IP or CIDR&gt; -rorule any -rwrule any   Add export policy to SVM root volume otherwise OpenStack host wont have write permission   volume modify -vserver &lt;svm&gt; -volume &lt;rootvol&gt; -policy openstack   Create NetApp Volumes NetApp volumes are containers for storing files or LUNs. In the case of OpenStack a NetApp volume is a container for Cinder volumes which is a container for block devices. We will create three volumes for Cinder and each volume will define a different storage service e.g. gold, silver and bronze. In addition we will create a fourth volume for storing glance images. The beauty here is that the storage admin can define storage services based on containers and expose them up through Cinder for consumption in OpenStack. Clustered Data ONTAP allows us to mix SSDs and Spinning Disk in the same storage system to enable building services with different performance characteristics. One can create aggregates which contain NetApp volumes using SSDs, Spinning Disk or even a mix (hybrid aggregates). In addition Clustered Data ONTAP provides QoS at the IOP or bandwidth level which we can use to further define or even restrict our storage services. Gold Volume The gold volume will be our most expensive storage service but will have the best performance and availability. We will create a volume on the best performing aggregate and in addition mirror that volume to another SVM.   volume create -vserver &lt;svm&gt; -volume openstack_gold -aggregate &lt;aggr&gt; -size 500g -state online -type RW -policy openstack -snapshot-policy none -space-guarantee volume     volume mount -vserver &lt;svm&gt; -volume openstack_gold -junction-path /openstack_gold     snapmirror initialize -source-path &lt;svm&gt;:openstack_gold -destination-path &lt;svm dr&gt;:openstack_gold_dr   Silver Volume The silver volume will have a good price to performance but not include DR. We will create volume from a best performing aggregate and enable compression for space savings.   volume create -vserver &lt;svm&gt; -volume openstack_silver -aggregate &lt;aggr&gt; -size 500g -state online -type RW -policy openstack -snapshot-policy none -space-guarantee volume     volume mount -vserver &lt;svm&gt; -volume openstack_silver -junction-path /openstack_silver     volume efficiency on -vserver &lt;svm&gt; -volume openstack_silver     volume efficiency modify -vserver &lt;svm&gt; -volume openstack_silver -compression true -inline-compression true   Bronze Volume The bronze volume will have lower performing storage and be the most cost-effective service. We will create volume from lower performing aggregate and enable dedup for space savings. We will not enable DR.   volume create -vserver &lt;svm&gt; -volume openstack_bronze -aggregate &lt;aggr&gt; -size 500g -state online -type RW -policy openstack -snapshot-policy none -space-guarantee volume     volume mount -vserver &lt;svm&gt; -volume openstack_bronze -junction-path /openstack_bronze     volume efficiency on -vserver &lt;svm&gt; -volume openstack_bronze     volume efficiency policy create -vserver &lt;svm&gt; -policy bronze_dedupe -schedule  -duration - -enabled true   Glance Volume Finally we will create a volume for storing images in Glance. This volume does not have high performance requirements but we will certainly enable dedup to greatly reduce the storage footprint.   volume create -vserver &lt;svm&gt; -volume openstack_glance -aggregate &lt;aggr&gt; -size 500g -state online -type RW -policy openstack -snapshot-policy none -space-guarantee volume     volume mount -vserver &lt;svm&gt; -volume openstack_glance -junction-path /openstack_glance     volume efficiency on -vserver &lt;svm&gt; -volume openstack_bronze     volume efficiency policy create -vserver &lt;svm&gt; -policy bronze_dedupe -schedule  -duration - -enabled true   The next post in the series will cover configuring the above NetApp volumes in OpenStack as storage services. (c) 2014 Keith Tenzer">





  <meta name="twitter:site" content="@keithtenzer">
  <meta name="twitter:title" content="Building Storage Services in OpenStack on NetApp - Part II of III">
  <meta name="twitter:description" content="Welcome to part two of the three-part series on creating storage services in OpenStack on NetApp. In this post we will look at how to configure NetApp storage in a OpenStack environment. In part one of the series we looked at how to install and configure OpenStack. In part three we will look at how to configure storage services in OpenStack.  Building Storage Services in OpenStack on NetApp - Part I of III Building Storage Services in OpenStack on NetApp - Part III of III  Overview NetApp has the most unified storage combined with the best feature set in the industry. NetApp provides the only storage operating system which allows you to manage your data on-premise, off-premise, in private clouds, public clouds or even hybrid clouds. NetApp is a perfect fit for OpenStack as a storage platform. In this post we will explore why, discuss options and show you how to properly configure your NetApp storage system for OpenStack. Below is a diagram illustrating the broad-reaching data management capabilities of Data ONTAP:  Storage Considerations There are currently two OpenStack services which support storage: Cinder (block) and Swift (object). Manilla (file services) is an incubation project and slated for the kilo release later in 2015. For the purpose of this post I am going to focus on Cinder. E-Series vs FAS NetApp offers two product lines for storage the E-Series and FAS lines. I would not recommend choosing between E-Series or FAS as they have different uses in terms of OpenStack. E-Series is best used for Swift as a backend to object storage. It is very fast and has a great price to performance value. Swift is an object store and abstracts storage management. You want a fast, resilient, highly available storage system and that is the E-Series. The E-Series storage also has a nice feature called &quot;Dynamic Disk Pools&quot; which implements CRUSH (erasure coding) and it reduces storage footprint from 3x to just 1.25x for Swift in OpenStack environments. FAS is the clear choice when it comes to Cinder storage where you want data management features and capabilities exposed in OpenStack. ONTAP 7mode vs Clustered Data ONTAP In the FAS world there are also two choices. Personally I don&#39;t think it is much of a choice. Clustered Data ONTAP is the evolution of FAS storage. It is a scale-out architecture and scales in three dimensions: operations, performance and capacity. It is by far the most complete storage system ever built and certainly most capable storage system on the market today. Clustered Data ONTAP virtualizes storage into what are called Storage Virtual Machines (SVMs) which enable secure multi-tenancy. If we think about cloud computing platforms, multi-tenancy is the basis and a raw ingredient. Clustered Data ONTAP provides world-class data management, scalability in multiple dimensions, unified protocols (ISCSI, NFS, CIFS, and FC) and non-disruptive always-on operations in the same storage system. The only reason not to go with Clustered Data ONTAP is that you already have 7mode and don&#39;t have budget, otherwise it is no-brainer. NetApp of course supports 7mode with its OpenStack driver so this is an option for those that can&#39;t go with Clustered Data ONTAP. Storage Protocol There are two options for connecting storage to Cinder: ISCSI or NFS. At this time Fiber Chanel (FC) is not supported and if we consider cloud computing architectures, FC does not really have the horizontal scalability required. Let&#39;s face it we don&#39;t need a second segregated island for data traffic, IP networks are proven and scale, FC is simply out of this picture. Cinder exposes block devices to virtual machines or instances but it can reside on both NFS or ISCSI storage. I would recommend NFS as NFS storage is much easier to manage than ISCSI. However if you are a SAN only shop or coming from a SAN environment, ISCSI might be a nice way to bridge into OpenStack and not have to make changes to how hosts connect to their storage. You can even use a combination of both. You could use NFS for creating Cinder volumes where instances reside and ISCSI for host mount points. Again I would recommend NFS for everything and that is what I am going to cover but I wanted to at least explain both options. Configuring Clustered Data ONTAP We have made the following storage decisions for our OpenStack Cinder configuration:  FAS (storage platform) Clustered Data ONTAP (storage operating system) NFS (protocol)  Storage Virtual Machines Configure two storage virtual machines. One will be used to provide storage to Cinder volumes and the other for DR. At a minimum you will need two IPs for each SVM. One for the management LIF and the other the data LIF. Ensure that both SVMs data LIFs are reachable from the OpenStack host. Create SVMs   vserver create -vserver &lt;svm&gt; -subtype default -rootvolume &lt;rootvol&gt; -aggregate &lt;aggr&gt; -rootvolume-security-style unix   Create management LIFs   net int create -vserver &lt;svm&gt; -lif data -role data -data-protocol nfs -home-node steve-02 -home-port e0a -address &lt;ip&gt; -netmask &lt;netmask&gt; -firewall-policy mgmt   Create Data LIFs   net int create -vserver &lt;svm&gt; -lif data -role data -data-protocol nfs -home-node steve-02 -home-port e0a -address &lt;ip&gt; -netmask &lt;netmask&gt; -firewall-policy data   Ensure NFS services are running on both SVMs   nfs status -vserver   If NFS is not running you can start NFS as follows:   nfs on -vserver   nfs start -vserver   Create Export policy In order to export NetApp volumes to OpenStack via NFS we need an export policy. Create an export policy as follows:   export-policy create -vserver &lt;svm&gt; -policyname openstack     export-policy rule create -vserver &lt;svm&gt; -policyname openstack -clientmatch &lt;IP or CIDR&gt; -rorule any -rwrule any   Add export policy to SVM root volume otherwise OpenStack host wont have write permission   volume modify -vserver &lt;svm&gt; -volume &lt;rootvol&gt; -policy openstack   Create NetApp Volumes NetApp volumes are containers for storing files or LUNs. In the case of OpenStack a NetApp volume is a container for Cinder volumes which is a container for block devices. We will create three volumes for Cinder and each volume will define a different storage service e.g. gold, silver and bronze. In addition we will create a fourth volume for storing glance images. The beauty here is that the storage admin can define storage services based on containers and expose them up through Cinder for consumption in OpenStack. Clustered Data ONTAP allows us to mix SSDs and Spinning Disk in the same storage system to enable building services with different performance characteristics. One can create aggregates which contain NetApp volumes using SSDs, Spinning Disk or even a mix (hybrid aggregates). In addition Clustered Data ONTAP provides QoS at the IOP or bandwidth level which we can use to further define or even restrict our storage services. Gold Volume The gold volume will be our most expensive storage service but will have the best performance and availability. We will create a volume on the best performing aggregate and in addition mirror that volume to another SVM.   volume create -vserver &lt;svm&gt; -volume openstack_gold -aggregate &lt;aggr&gt; -size 500g -state online -type RW -policy openstack -snapshot-policy none -space-guarantee volume     volume mount -vserver &lt;svm&gt; -volume openstack_gold -junction-path /openstack_gold     snapmirror initialize -source-path &lt;svm&gt;:openstack_gold -destination-path &lt;svm dr&gt;:openstack_gold_dr   Silver Volume The silver volume will have a good price to performance but not include DR. We will create volume from a best performing aggregate and enable compression for space savings.   volume create -vserver &lt;svm&gt; -volume openstack_silver -aggregate &lt;aggr&gt; -size 500g -state online -type RW -policy openstack -snapshot-policy none -space-guarantee volume     volume mount -vserver &lt;svm&gt; -volume openstack_silver -junction-path /openstack_silver     volume efficiency on -vserver &lt;svm&gt; -volume openstack_silver     volume efficiency modify -vserver &lt;svm&gt; -volume openstack_silver -compression true -inline-compression true   Bronze Volume The bronze volume will have lower performing storage and be the most cost-effective service. We will create volume from lower performing aggregate and enable dedup for space savings. We will not enable DR.   volume create -vserver &lt;svm&gt; -volume openstack_bronze -aggregate &lt;aggr&gt; -size 500g -state online -type RW -policy openstack -snapshot-policy none -space-guarantee volume     volume mount -vserver &lt;svm&gt; -volume openstack_bronze -junction-path /openstack_bronze     volume efficiency on -vserver &lt;svm&gt; -volume openstack_bronze     volume efficiency policy create -vserver &lt;svm&gt; -policy bronze_dedupe -schedule  -duration - -enabled true   Glance Volume Finally we will create a volume for storing images in Glance. This volume does not have high performance requirements but we will certainly enable dedup to greatly reduce the storage footprint.   volume create -vserver &lt;svm&gt; -volume openstack_glance -aggregate &lt;aggr&gt; -size 500g -state online -type RW -policy openstack -snapshot-policy none -space-guarantee volume     volume mount -vserver &lt;svm&gt; -volume openstack_glance -junction-path /openstack_glance     volume efficiency on -vserver &lt;svm&gt; -volume openstack_bronze     volume efficiency policy create -vserver &lt;svm&gt; -policy bronze_dedupe -schedule  -duration - -enabled true   The next post in the series will cover configuring the above NetApp volumes in OpenStack as storage services. (c) 2014 Keith Tenzer">
  <meta name="twitter:url" content="http://localhost:4000/openstack/building-storage-services-in-openstack-on-netapp-part-ii-of-iii/">

  
    <meta name="twitter:card" content="summary">
    
  

  



  <meta property="article:published_time" content="2014-12-09T00:00:00-08:00">





  

  


<link rel="canonical" href="http://localhost:4000/openstack/building-storage-services-in-openstack-on-netapp-part-ii-of-iii/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Keith Tenzer",
      "url": "http://localhost:4000/"
    
  }
</script>







<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Keith Tenzer's Blog Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->


    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          Keith Tenzer's Blog
          <span class="site-subtitle">Cloud Computing and Code</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/about/index.html">About</a>
            </li><li class="masthead__menu-item">
              <a href="/conferences-and-events/index.html">Conferences and Events</a>
            </li><li class="masthead__menu-item">
              <a href="/videos/index.html">Videos</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      


  
    



<nav class="breadcrumbs">
  <ol itemscope itemtype="https://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="http://localhost:4000/" itemprop="item"><span itemprop="name">Home</span></a>
          <meta itemprop="position" content="1" />
        </li>
        <span class="sep">/</span>
      
      
        
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="/categories/#openstack" itemprop="item"><span itemprop="name">Openstack</span></a>
          <meta itemprop="position" content="2" />
        </li>
        <span class="sep">/</span>
      
    
      
      
        <li class="current">Building Storage Services in OpenStack on NetApp - Part II of III</li>
      
    
  </ol>
</nav>

  


<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/assets/main/me.png" alt="Keith Tenzer" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Keith Tenzer</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>Solutions Architect at Temporal</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Los Angeles, CA</span>
        </li>
      

      
        
          
        
          
        
          
            <li><a href="https://twitter.com/keithtenzer" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
          
        
          
        
          
            <li><a href="https://github.com/ktenzer" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Building Storage Services in OpenStack on NetApp - Part II of III">
    <meta itemprop="description" content="Welcome to part two of the three-part series on creating storage services in OpenStack on NetApp. In this post we will look at how to configure NetApp storage in a OpenStack environment. In part one of the series we looked at how to install and configure OpenStack. In part three we will look at how to configure storage services in OpenStack.Building Storage Services in OpenStack on NetApp - Part I of IIIBuilding Storage Services in OpenStack on NetApp - Part III of IIIOverviewNetApp has the most unified storage combined with the best feature set in the industry. NetApp provides the only storage operating system which allows you to manage your data on-premise, off-premise, in private clouds, public clouds or even hybrid clouds. NetApp is a perfect fit for OpenStack as a storage platform. In this post we will explore why, discuss options and show you how to properly configure your NetApp storage system for OpenStack.Below is a diagram illustrating the broad-reaching data management capabilities of Data ONTAP:Storage ConsiderationsThere are currently two OpenStack services which support storage: Cinder (block) and Swift (object). Manilla (file services) is an incubation project and slated for the kilo release later in 2015. For the purpose of this post I am going to focus on Cinder.E-Series vs FASNetApp offers two product lines for storage the E-Series and FAS lines. I would not recommend choosing between E-Series or FAS as they have different uses in terms of OpenStack. E-Series is best used for Swift as a backend to object storage. It is very fast and has a great price to performance value. Swift is an object store and abstracts storage management. You want a fast, resilient, highly available storage system and that is the E-Series. The E-Series storage also has a nice feature called &quot;Dynamic Disk Pools&quot; which implements CRUSH (erasure coding) and it reduces storage footprint from 3x to just 1.25x for Swift in OpenStack environments.FAS is the clear choice when it comes to Cinder storage where you want data management features and capabilities exposed in OpenStack.ONTAP 7mode vs Clustered Data ONTAPIn the FAS world there are also two choices. Personally I don&#39;t think it is much of a choice. Clustered Data ONTAP is the evolution of FAS storage. It is a scale-out architecture and scales in three dimensions: operations, performance and capacity. It is by far the most complete storage system ever built and certainly most capable storage system on the market today. Clustered Data ONTAP virtualizes storage into what are called Storage Virtual Machines (SVMs) which enable secure multi-tenancy. If we think about cloud computing platforms, multi-tenancy is the basis and a raw ingredient. Clustered Data ONTAP provides world-class data management, scalability in multiple dimensions, unified protocols (ISCSI, NFS, CIFS, and FC) and non-disruptive always-on operations in the same storage system. The only reason not to go with Clustered Data ONTAP is that you already have 7mode and don&#39;t have budget, otherwise it is no-brainer. NetApp of course supports 7mode with its OpenStack driver so this is an option for those that can&#39;t go with Clustered Data ONTAP.Storage ProtocolThere are two options for connecting storage to Cinder: ISCSI or NFS. At this time Fiber Chanel (FC) is not supported and if we consider cloud computing architectures, FC does not really have the horizontal scalability required. Let&#39;s face it we don&#39;t need a second segregated island for data traffic, IP networks are proven and scale, FC is simply out of this picture.Cinder exposes block devices to virtual machines or instances but it can reside on both NFS or ISCSI storage. I would recommend NFS as NFS storage is much easier to manage than ISCSI. However if you are a SAN only shop or coming from a SAN environment, ISCSI might be a nice way to bridge into OpenStack and not have to make changes to how hosts connect to their storage. You can even use a combination of both. You could use NFS for creating Cinder volumes where instances reside and ISCSI for host mount points. Again I would recommend NFS for everything and that is what I am going to cover but I wanted to at least explain both options.Configuring Clustered Data ONTAPWe have made the following storage decisions for our OpenStack Cinder configuration:FAS (storage platform)Clustered Data ONTAP (storage operating system)NFS (protocol)Storage Virtual MachinesConfigure two storage virtual machines. One will be used to provide storage to Cinder volumes and the other for DR. At a minimum you will need two IPs for each SVM. One for the management LIF and the other the data LIF. Ensure that both SVMs data LIFs are reachable from the OpenStack host.Create SVMsvserver create -vserver &lt;svm&gt; -subtype default -rootvolume &lt;rootvol&gt; -aggregate &lt;aggr&gt; -rootvolume-security-style unixCreate management LIFsnet int create -vserver &lt;svm&gt; -lif data -role data -data-protocol nfs -home-node steve-02 -home-port e0a -address &lt;ip&gt; -netmask &lt;netmask&gt; -firewall-policy mgmtCreate Data LIFsnet int create -vserver &lt;svm&gt; -lif data -role data -data-protocol nfs -home-node steve-02 -home-port e0a -address &lt;ip&gt; -netmask &lt;netmask&gt; -firewall-policy dataEnsure NFS services are running on both SVMsnfs status -vserverIf NFS is not running you can start NFS as follows:nfs on -vservernfs start -vserverCreate Export policyIn order to export NetApp volumes to OpenStack via NFS we need an export policy. Create an export policy as follows:export-policy create -vserver &lt;svm&gt; -policyname openstackexport-policy rule create -vserver &lt;svm&gt; -policyname openstack -clientmatch &lt;IP or CIDR&gt; -rorule any -rwrule anyAdd export policy to SVM root volume otherwise OpenStack host wont have write permissionvolume modify -vserver &lt;svm&gt; -volume &lt;rootvol&gt; -policy openstackCreate NetApp VolumesNetApp volumes are containers for storing files or LUNs. In the case of OpenStack a NetApp volume is a container for Cinder volumes which is a container for block devices. We will create three volumes for Cinder and each volume will define a different storage service e.g. gold, silver and bronze. In addition we will create a fourth volume for storing glance images. The beauty here is that the storage admin can define storage services based on containers and expose them up through Cinder for consumption in OpenStack.Clustered Data ONTAP allows us to mix SSDs and Spinning Disk in the same storage system to enable building services with different performance characteristics. One can create aggregates which contain NetApp volumes using SSDs, Spinning Disk or even a mix (hybrid aggregates). In addition Clustered Data ONTAP provides QoS at the IOP or bandwidth level which we can use to further define or even restrict our storage services.Gold VolumeThe gold volume will be our most expensive storage service but will have the best performance and availability. We will create a volume on the best performing aggregate and in addition mirror that volume to another SVM.volume create -vserver &lt;svm&gt; -volume openstack_gold -aggregate &lt;aggr&gt; -size 500g -state online -type RW -policy openstack -snapshot-policy none -space-guarantee volumevolume mount -vserver &lt;svm&gt; -volume openstack_gold -junction-path /openstack_goldsnapmirror initialize -source-path &lt;svm&gt;:openstack_gold -destination-path &lt;svm dr&gt;:openstack_gold_drSilver VolumeThe silver volume will have a good price to performance but not include DR. We will create volume from a best performing aggregate and enable compression for space savings.volume create -vserver &lt;svm&gt; -volume openstack_silver -aggregate &lt;aggr&gt; -size 500g -state online -type RW -policy openstack -snapshot-policy none -space-guarantee volumevolume mount -vserver &lt;svm&gt; -volume openstack_silver -junction-path /openstack_silvervolume efficiency on -vserver &lt;svm&gt; -volume openstack_silvervolume efficiency modify -vserver &lt;svm&gt; -volume openstack_silver -compression true -inline-compression trueBronze VolumeThe bronze volume will have lower performing storage and be the most cost-effective service. We will create volume from lower performing aggregate and enable dedup for space savings. We will not enable DR.volume create -vserver &lt;svm&gt; -volume openstack_bronze -aggregate &lt;aggr&gt; -size 500g -state online -type RW -policy openstack -snapshot-policy none -space-guarantee volumevolume mount -vserver &lt;svm&gt; -volume openstack_bronze -junction-path /openstack_bronzevolume efficiency on -vserver &lt;svm&gt; -volume openstack_bronzevolume efficiency policy create -vserver &lt;svm&gt; -policy bronze_dedupe -schedule  -duration - -enabled trueGlance VolumeFinally we will create a volume for storing images in Glance. This volume does not have high performance requirements but we will certainly enable dedup to greatly reduce the storage footprint.volume create -vserver &lt;svm&gt; -volume openstack_glance -aggregate &lt;aggr&gt; -size 500g -state online -type RW -policy openstack -snapshot-policy none -space-guarantee volumevolume mount -vserver &lt;svm&gt; -volume openstack_glance -junction-path /openstack_glancevolume efficiency on -vserver &lt;svm&gt; -volume openstack_bronzevolume efficiency policy create -vserver &lt;svm&gt; -policy bronze_dedupe -schedule  -duration - -enabled trueThe next post in the series will cover configuring the above NetApp volumes in OpenStack as storage services.(c) 2014 Keith Tenzer">
    <meta itemprop="datePublished" content="2014-12-09T00:00:00-08:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Building Storage Services in OpenStack on NetApp - Part II of III
</h1>
          

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2014-12-09T00:00:00-08:00">December 9, 2014</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          14 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
        <p>Welcome to part two of the three-part series on creating storage services in OpenStack on NetApp. In this post we will look at how to configure NetApp storage in a OpenStack environment. In part one of the series we looked at how to install and configure OpenStack. In part three we will look at how to configure storage services in OpenStack.<!--more--></p>
<ul>
<li><a href="http://keithtenzer.com/2014/12/05/creating-storage-services-in-openstack-on-netapp-part-i-of-iii/">Building Storage Services in OpenStack on NetApp - Part I of III</a></li>
<li><a href="//keithtenzer.com/2014/12/10/building-storage-services-in-openstack-on-netapp-part-iii-of-iii/">Building Storage Services in OpenStack on NetApp - Part III of III</a></li>
</ul>
<h3>Overview</h3>
<p>NetApp has the most unified storage combined with the best feature set in the industry. NetApp provides the only storage operating system which allows you to manage your data on-premise, off-premise, in private clouds, public clouds or even hybrid clouds. NetApp is a perfect fit for OpenStack as a storage platform. In this post we will explore why, discuss options and show you how to properly configure your NetApp storage system for OpenStack.</p>
<p>Below is a diagram illustrating the broad-reaching data management capabilities of Data ONTAP:</p>
<p><a href="https://keithtenzer.files.wordpress.com/2014/12/ontap_architecture1.jpg"><img class="  wp-image-190 aligncenter" src="/assets/2014/12/ontap_architecture1.jpg?w=300" alt="ontap_architecture" width="716" height="296" /></a></p>
<h3>Storage Considerations</h3>
<p>There are currently two OpenStack services which support storage: Cinder (block) and Swift (object). Manilla (file services) is an incubation project and slated for the kilo release later in 2015. For the purpose of this post I am going to focus on Cinder.</p>
<h4>E-Series vs FAS</h4>
<p>NetApp offers two product lines for storage the E-Series and FAS lines. I would not recommend choosing between E-Series or FAS as they have different uses in terms of OpenStack. E-Series is best used for Swift as a backend to object storage. It is very fast and has a great price to performance value. Swift is an object store and abstracts storage management. You want a fast, resilient, highly available storage system and that is the E-Series. The E-Series storage also has a nice feature called "Dynamic Disk Pools" which implements CRUSH (erasure coding) and it reduces storage footprint from 3x to just 1.25x for Swift in OpenStack environments.</p>
<p>FAS is the clear choice when it comes to Cinder storage where you want data management features and capabilities exposed in OpenStack.</p>
<h4>ONTAP 7mode vs Clustered Data ONTAP</h4>
<p>In the FAS world there are also two choices. Personally I don't think it is much of a choice. Clustered Data ONTAP is the evolution of FAS storage. It is a scale-out architecture and scales in three dimensions: operations, performance and capacity. It is by far the most complete storage system ever built and certainly most capable storage system on the market today. Clustered Data ONTAP virtualizes storage into what are called Storage Virtual Machines (SVMs) which enable secure multi-tenancy. If we think about cloud computing platforms, multi-tenancy is the basis and a raw ingredient. Clustered Data ONTAP provides world-class data management, scalability in multiple dimensions, unified protocols (ISCSI, NFS, CIFS, and FC) and non-disruptive always-on operations in the same storage system. The only reason not to go with Clustered Data ONTAP is that you already have 7mode and don't have budget, otherwise it is no-brainer. NetApp of course supports 7mode with its OpenStack driver so this is an option for those that can't go with Clustered Data ONTAP.</p>
<h3>Storage Protocol</h3>
<p>There are two options for connecting storage to Cinder: ISCSI or NFS. At this time Fiber Chanel (FC) is not supported and if we consider cloud computing architectures, FC does not really have the horizontal scalability required. Let's face it we don't need a second segregated island for data traffic, IP networks are proven and scale, FC is simply out of this picture.</p>
<p>Cinder exposes block devices to virtual machines or instances but it can reside on both NFS or ISCSI storage. I would recommend NFS as NFS storage is much easier to manage than ISCSI. However if you are a SAN only shop or coming from a SAN environment, ISCSI might be a nice way to bridge into OpenStack and not have to make changes to how hosts connect to their storage. You can even use a combination of both. You could use NFS for creating Cinder volumes where instances reside and ISCSI for host mount points. Again I would recommend NFS for everything and that is what I am going to cover but I wanted to at least explain both options.</p>
<h3>Configuring Clustered Data ONTAP</h3>
<p>We have made the following storage decisions for our OpenStack Cinder configuration:</p>
<ul>
<li>FAS (storage platform)</li>
<li>Clustered Data ONTAP (storage operating system)</li>
<li>NFS (protocol)</li>
</ul>
<h4>Storage Virtual Machines</h4>
<p>Configure two storage virtual machines. One will be used to provide storage to Cinder volumes and the other for DR. At a minimum you will need two IPs for each SVM. One for the management LIF and the other the data LIF. Ensure that both SVMs data LIFs are reachable from the OpenStack host.</p>
<p>Create SVMs</p>
<ul>
<li>
<pre>vserver create -vserver &lt;svm&gt; -subtype default -rootvolume &lt;rootvol&gt; -aggregate &lt;aggr&gt; -rootvolume-security-style unix</pre>
</li>
</ul>
<p>Create management LIFs</p>
<ul>
<li>
<pre>net int create -vserver &lt;svm&gt; -lif data -role data -data-protocol nfs -home-node steve-02 -home-port e0a -address &lt;ip&gt; -netmask &lt;netmask&gt; -firewall-policy mgmt</pre>
</li>
</ul>
<p>Create Data LIFs</p>
<ul>
<li>
<pre>net int create -vserver &lt;svm&gt; -lif data -role data -data-protocol nfs -home-node steve-02 -home-port e0a -address &lt;ip&gt; -netmask &lt;netmask&gt; -firewall-policy data</pre>
</li>
</ul>
<p>Ensure NFS services are running on both SVMs</p>
<ul>
<li>
<pre>nfs status -vserver</pre>
</li>
</ul>
<p>If NFS is not running you can start NFS as follows:</p>
<ul>
<li>
<pre>nfs on -vserver</pre>
</li>
<li>
<pre>nfs start -vserver</pre>
</li>
</ul>
<h4>Create Export policy</h4>
<p>In order to export NetApp volumes to OpenStack via NFS we need an export policy. Create an export policy as follows:</p>
<ul>
<li>
<pre>export-policy create -vserver &lt;svm&gt; -policyname openstack</pre>
</li>
</ul>
<ul>
<li>
<pre>export-policy rule create -vserver &lt;svm&gt; -policyname openstack -clientmatch &lt;IP or CIDR&gt; -rorule any -rwrule any</pre>
</li>
</ul>
<p>Add export policy to SVM root volume otherwise OpenStack host wont have write permission</p>
<ul>
<li>
<pre>volume modify -vserver &lt;svm&gt; -volume &lt;rootvol&gt; -policy openstack</pre>
</li>
</ul>
<h4>Create NetApp Volumes</h4>
<p>NetApp volumes are containers for storing files or LUNs. In the case of OpenStack a NetApp volume is a container for Cinder volumes which is a container for block devices. We will create three volumes for Cinder and each volume will define a different storage service e.g. gold, silver and bronze. In addition we will create a fourth volume for storing glance images. The beauty here is that the storage admin can define storage services based on containers and expose them up through Cinder for consumption in OpenStack.</p>
<p>Clustered Data ONTAP allows us to mix SSDs and Spinning Disk in the same storage system to enable building services with different performance characteristics. One can create aggregates which contain NetApp volumes using SSDs, Spinning Disk or even a mix (hybrid aggregates). In addition Clustered Data ONTAP provides QoS at the IOP or bandwidth level which we can use to further define or even restrict our storage services.</p>
<h5>Gold Volume</h5>
<p>The gold volume will be our most expensive storage service but will have the best performance and availability. We will create a volume on the best performing aggregate and in addition mirror that volume to another SVM.</p>
<ul>
<li>
<pre>volume create -vserver &lt;svm&gt; -volume openstack_gold -aggregate &lt;aggr&gt; -size 500g -state online -type RW -policy openstack -snapshot-policy none -space-guarantee volume</pre>
</li>
</ul>
<ul>
<li>
<pre>volume mount -vserver &lt;svm&gt; -volume openstack_gold -junction-path /openstack_gold</pre>
</li>
</ul>
<ul>
<li>
<pre>snapmirror initialize -source-path &lt;svm&gt;:openstack_gold -destination-path &lt;svm dr&gt;:openstack_gold_dr</pre>
</li>
</ul>
<h5>Silver Volume</h5>
<p>The silver volume will have a good price to performance but not include DR. We will create volume from a best performing aggregate and enable compression for space savings.</p>
<ul>
<li>
<pre>volume create -vserver &lt;svm&gt; -volume openstack_silver -aggregate &lt;aggr&gt; -size 500g -state online -type RW -policy openstack -snapshot-policy none -space-guarantee volume</pre>
</li>
</ul>
<ul>
<li>
<pre>volume mount -vserver &lt;svm&gt; -volume openstack_silver -junction-path /openstack_silver</pre>
</li>
</ul>
<ul>
<li>
<pre>volume efficiency on -vserver &lt;svm&gt; -volume openstack_silver</pre>
</li>
</ul>
<ul>
<li>
<pre>volume efficiency modify -vserver &lt;svm&gt; -volume openstack_silver -compression true -inline-compression true</pre>
</li>
</ul>
<h5>Bronze Volume</h5>
<p>The bronze volume will have lower performing storage and be the most cost-effective service. We will create volume from lower performing aggregate and enable dedup for space savings. We will not enable DR.</p>
<ul>
<li>
<pre>volume create -vserver &lt;svm&gt; -volume openstack_bronze -aggregate &lt;aggr&gt; -size 500g -state online -type RW -policy openstack -snapshot-policy none -space-guarantee volume</pre>
</li>
</ul>
<ul>
<li>
<pre>volume mount -vserver &lt;svm&gt; -volume openstack_bronze -junction-path /openstack_bronze</pre>
</li>
</ul>
<ul>
<li>
<pre>volume efficiency on -vserver &lt;svm&gt; -volume openstack_bronze</pre>
</li>
</ul>
<ul>
<li>
<pre>volume efficiency policy create -vserver &lt;svm&gt; -policy bronze_dedupe -schedule  -duration - -enabled true</pre>
</li>
</ul>
<h5>Glance Volume</h5>
<p>Finally we will create a volume for storing images in Glance. This volume does not have high performance requirements but we will certainly enable dedup to greatly reduce the storage footprint.</p>
<ul>
<li>
<pre>volume create -vserver &lt;svm&gt; -volume openstack_glance -aggregate &lt;aggr&gt; -size 500g -state online -type RW -policy openstack -snapshot-policy none -space-guarantee volume</pre>
</li>
</ul>
<ul>
<li>
<pre>volume mount -vserver &lt;svm&gt; -volume openstack_glance -junction-path /openstack_glance</pre>
</li>
</ul>
<ul>
<li>
<pre>volume efficiency on -vserver &lt;svm&gt; -volume openstack_bronze</pre>
</li>
</ul>
<ul>
<li>
<pre>volume efficiency policy create -vserver &lt;svm&gt; -policy bronze_dedupe -schedule  -duration - -enabled true</pre>
</li>
</ul>
<p>The next post in the series will cover configuring the above NetApp volumes in OpenStack as storage services.</p>
<p>(c) 2014 Keith Tenzer</p>

        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/#cloud" class="page__taxonomy-item" rel="tag">Cloud</a><span class="sep">, </span>
    
      <a href="/tags/#clustered-data-ontap" class="page__taxonomy-item" rel="tag">Clustered Data ONTAP</a><span class="sep">, </span>
    
      <a href="/tags/#netapp" class="page__taxonomy-item" rel="tag">NetApp</a><span class="sep">, </span>
    
      <a href="/tags/#openstack" class="page__taxonomy-item" rel="tag">OpenStack</a>
    
    </span>
  </p>




  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      <a href="/categories/#openstack" class="page__taxonomy-item" rel="tag">OpenStack</a>
    
    </span>
  </p>


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2014-12-09T00:00:00-08:00">December 9, 2014</time></p>


      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?via=keithtenzer&text=Building+Storage+Services+in+OpenStack+on+NetApp+-+Part+II+of+III%20http%3A%2F%2Flocalhost%3A4000%2Fopenstack%2Fbuilding-storage-services-in-openstack-on-netapp-part-ii-of-iii%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2Fopenstack%2Fbuilding-storage-services-in-openstack-on-netapp-part-ii-of-iii%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2Fopenstack%2Fbuilding-storage-services-in-openstack-on-netapp-part-ii-of-iii%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/openstack/creating-storage-services-in-openstack-on-netapp-part-i-of-iii/" class="pagination--pager" title="Building Storage Services in OpenStack on NetApp - Part I of III
">Previous</a>
    
    
      <a href="/openstack/building-storage-services-in-openstack-on-netapp-part-iii-of-iii/" class="pagination--pager" title="Building Storage Services in OpenStack on NetApp - Part III of III
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You may also enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/temporal/temporal_getting_started_guide/" rel="permalink">Temporal Getting Started Guide
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2022-08-24T00:00:00-07:00">August 24, 2022</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          7 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
Overview
In this article we will walk through setup of a development environment for Temporal. There are of course, several ways you can run the Temporal se...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/temporal/my-first-day-at-temporal/" rel="permalink">My First Day at Temporal
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2022-08-15T00:00:00-07:00">August 15, 2022</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          9 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
Overview
Today is my first day at temporal and with that I wanted to share some thoughts around my decision, why Temporal and my experience thus far. As you...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/linux/blog-with-gitops-practices-and-github/" rel="permalink">Blog with Gitops Practices and GitHub
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2022-02-10T00:00:00-08:00">February 10, 2022</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          13 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Overview
Want to build your brand, while living the gitops revolution and not paying anything for it? That is exactly what this article will walk you through...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/linux/The-Fedora-Workstation-Experience/" rel="permalink">The Fedora Workstation Experience
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2022-01-10T00:00:00-08:00">January 10, 2022</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          10 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
Overview
A lot of people always ask me what is the best way to contribute to opensource? Of course contributing code, documentation, spreading the gospel or...</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
          <li><a href="https://twitter.com/keithtenzer"" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
        
      
        
      
        
          <li><a href="https://github.com/ktenzer" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
      
        
      
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2022 Keith Tenzer. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>







  </body>
</html>
