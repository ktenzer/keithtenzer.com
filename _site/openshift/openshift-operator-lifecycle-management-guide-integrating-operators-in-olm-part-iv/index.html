<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.22.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
<link rel="icon" href="/assets/main/me.png">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>OpenShift Operator Lifecycle Management Guide: Integrating Operators in OLM Part IV - Keith Tenzerâ€™s Blog</title>
<meta name="description" content="Overview In this article we will provide a hands-on guide to integrating your already built Operator with the Operator Lifecycle Manager (OLM). Using the Operator SDK and OPM tool we will create the application manifests and images so your application Operator can be managed through OLM. This article is part of a series that will walk you through understanding and building operators in Go or Ansible end-to-end.  OpenShift Operator Getting Started Part I OpenShift Operator SDK: Go Getting Started Guide Part II OpenShift Operator SDK: Ansible Getting Started Guide Part III OpenShift Operator Lifecycle Management Guide: Integrating Operators in OLM Part IV   In order to add your Operator to OLM you will need two tools: the operator-sdk and opm. Download the binaries for operator-sdk and opm. Install them under /usr/local/bin. Create Cluster Service Version The Cluster Service Version (CSV) is the manifest that allows your application operator to be bundled and exposed to the OLM API. The CSV is itself a CRD in kubernetes. Before creating a the CSV manifest you need the deployment scafolding. These are the objects and CRDs that your Operator require. These are created automatically when using the operator-sdk to create a application under the deploy directory. $ operator-sdk new cars-operator --repo github.com/cars-operator When generating an CSV you will provide the path to the deploy directory where those objects can be found. $ operator-sdk generate csv --csv-version 1.0.0 --deploy-dir deploy The generate csv command will create an olm_catalog/cars-operator/manifests directory. There you will find the &#39;clusterserviceversion&#39; yaml. You will however want to edit and add a lot. As such I have provided an example csv for an Operator I built. Note: If you want to add an icon, so it shows up nicely in Operator Hub, the image needs to be a base64 bit stream inside the csv. $ cat myimage.png | base64 Create Application Operator Catalog Bundle Now that we have generated and updated our CSV we can create an application bundle. $ sudo operator-sdk bundle create quay.io/ktenzer/podium-operator-catalog:latest \ --channels beta --package podium-operator-catalog --directory \ deploy/olm-catalog/podium-operator/manifests This will package the application manifest into a container image. Push the image to a public or private repository. $ sudo docker push quay.io/ktenzer/podium-operator-catalog:latest Create Application Operator Catalog Index Once we have bundled an application operator we can add it to a catalog index. The catalog index provides one or more application bundles to OLM. This is also what the Operator Hub directly interfaces with. $ sudo opm index add -c docker --bundles \ quay.io/ktenzer/podium-operator-catalog:latest \ --tag quay.io/ktenzer/podium-operator-index:latest Again an image is created that needs to be pushed to our private or public repository. $ sudo docker push quay.io/ktenzer/podium-operator-index:latest Deploy Catalog Source A catalog source is a CRD that defines an OLM catalog and points to a catalog index image, for example the one we just created. Create a catalog source yaml file that points to the catalog index image. $ vi catalog_source.yaml apiVersion: operators.coreos.com/v1alpha1 kind: CatalogSource metadata:   name: podium-operator-catalog spec:   sourceType: grpc   image: quay.io/ktenzer/podium-operator-index:latest   displayName: Podium Operator Catalog   publisher: Podium Community Deploy the catalog source under the openshift-marketplace namespace or where you have deployed OLM. $ oc create -f catalog_source.yaml -n openshift-marketplace Below we can see a list of catalogs. Again each catalog can contain one or more applications. All are default in OpenShift, except the one in bold which I added. $ oc get catalogsource -n openshift-marketplace NAME                     DISPLAY                 TYPE PUBLISHER        AGE certified-operators      Certified Operators     grpc Red Hat          18d community-operators      Community Operators     grpc Red Hat          18d podium-operator-catalog  Podium Operator Catalog grpc Podium Community 31m redhat-operators         Red Hat Operators       grpc Red Hat          18d Each catalog has it&#39;s own operator / pod. $ oc get pods -n openshift-marketplace NAME                                    READY   STATUS    RESTARTS   AGE certified-operators-76d9d8b886-bnsz7    1/1     Running   0          14h community-operators-74d675f545-g7d2t    1/1     Running   0          18h podium-operator-catalog-67gsk           1/1     Running   0          31m marketplace-operator-75f49679d7-n7v2r   1/1     Running   0          17d redhat-operators-87d549bf4-mxf7w        1/1     Running   0          13h Once a catalog operator exists, the applications it offers will show up in Operator Hub and can be installed.  Operators can be cluster-wide or namespace scoped. The Operator Lifecycle Management also provides a subscription, allowing updates to be pulled from various channels. This is similar to the relationship between an RPM and Repository.  After you deploy application via Operator Hub it will launch the operator. Cluster-wide operators will run in the openshift-operators namespace while namespaced operators will only run in a user defined namespace. $ oc get pods -n openshift-operators NAME                               READY   STATUS    RESTARTS   AGE podium-operator-6855dc9478-q65bt   1/1     Running   0          38m Summary In this article we stepped through the process of integrating an already existing operator with the Operator Lifecycle Manager. We saw how to generate an application manifest, build an application catalog bundle, add the bundle to an application index and finally deploy the application catalog, seamlessly integrating with Operator Hub. Using OLM provides not only a way to install applications but manage their lifecycle, releases and updates. Happy Operatoring! (c) 2020 Keith Tenzer">


  <meta name="author" content="Keith Tenzer">
  
  <meta property="article:author" content="Keith Tenzer">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Keith Tenzer's Blog">
<meta property="og:title" content="OpenShift Operator Lifecycle Management Guide: Integrating Operators in OLM Part IV">
<meta property="og:url" content="http://localhost:4000/openshift/openshift-operator-lifecycle-management-guide-integrating-operators-in-olm-part-iv/">


  <meta property="og:description" content="Overview In this article we will provide a hands-on guide to integrating your already built Operator with the Operator Lifecycle Manager (OLM). Using the Operator SDK and OPM tool we will create the application manifests and images so your application Operator can be managed through OLM. This article is part of a series that will walk you through understanding and building operators in Go or Ansible end-to-end.  OpenShift Operator Getting Started Part I OpenShift Operator SDK: Go Getting Started Guide Part II OpenShift Operator SDK: Ansible Getting Started Guide Part III OpenShift Operator Lifecycle Management Guide: Integrating Operators in OLM Part IV   In order to add your Operator to OLM you will need two tools: the operator-sdk and opm. Download the binaries for operator-sdk and opm. Install them under /usr/local/bin. Create Cluster Service Version The Cluster Service Version (CSV) is the manifest that allows your application operator to be bundled and exposed to the OLM API. The CSV is itself a CRD in kubernetes. Before creating a the CSV manifest you need the deployment scafolding. These are the objects and CRDs that your Operator require. These are created automatically when using the operator-sdk to create a application under the deploy directory. $ operator-sdk new cars-operator --repo github.com/cars-operator When generating an CSV you will provide the path to the deploy directory where those objects can be found. $ operator-sdk generate csv --csv-version 1.0.0 --deploy-dir deploy The generate csv command will create an olm_catalog/cars-operator/manifests directory. There you will find the &#39;clusterserviceversion&#39; yaml. You will however want to edit and add a lot. As such I have provided an example csv for an Operator I built. Note: If you want to add an icon, so it shows up nicely in Operator Hub, the image needs to be a base64 bit stream inside the csv. $ cat myimage.png | base64 Create Application Operator Catalog Bundle Now that we have generated and updated our CSV we can create an application bundle. $ sudo operator-sdk bundle create quay.io/ktenzer/podium-operator-catalog:latest \ --channels beta --package podium-operator-catalog --directory \ deploy/olm-catalog/podium-operator/manifests This will package the application manifest into a container image. Push the image to a public or private repository. $ sudo docker push quay.io/ktenzer/podium-operator-catalog:latest Create Application Operator Catalog Index Once we have bundled an application operator we can add it to a catalog index. The catalog index provides one or more application bundles to OLM. This is also what the Operator Hub directly interfaces with. $ sudo opm index add -c docker --bundles \ quay.io/ktenzer/podium-operator-catalog:latest \ --tag quay.io/ktenzer/podium-operator-index:latest Again an image is created that needs to be pushed to our private or public repository. $ sudo docker push quay.io/ktenzer/podium-operator-index:latest Deploy Catalog Source A catalog source is a CRD that defines an OLM catalog and points to a catalog index image, for example the one we just created. Create a catalog source yaml file that points to the catalog index image. $ vi catalog_source.yaml apiVersion: operators.coreos.com/v1alpha1 kind: CatalogSource metadata:   name: podium-operator-catalog spec:   sourceType: grpc   image: quay.io/ktenzer/podium-operator-index:latest   displayName: Podium Operator Catalog   publisher: Podium Community Deploy the catalog source under the openshift-marketplace namespace or where you have deployed OLM. $ oc create -f catalog_source.yaml -n openshift-marketplace Below we can see a list of catalogs. Again each catalog can contain one or more applications. All are default in OpenShift, except the one in bold which I added. $ oc get catalogsource -n openshift-marketplace NAME                     DISPLAY                 TYPE PUBLISHER        AGE certified-operators      Certified Operators     grpc Red Hat          18d community-operators      Community Operators     grpc Red Hat          18d podium-operator-catalog  Podium Operator Catalog grpc Podium Community 31m redhat-operators         Red Hat Operators       grpc Red Hat          18d Each catalog has it&#39;s own operator / pod. $ oc get pods -n openshift-marketplace NAME                                    READY   STATUS    RESTARTS   AGE certified-operators-76d9d8b886-bnsz7    1/1     Running   0          14h community-operators-74d675f545-g7d2t    1/1     Running   0          18h podium-operator-catalog-67gsk           1/1     Running   0          31m marketplace-operator-75f49679d7-n7v2r   1/1     Running   0          17d redhat-operators-87d549bf4-mxf7w        1/1     Running   0          13h Once a catalog operator exists, the applications it offers will show up in Operator Hub and can be installed.  Operators can be cluster-wide or namespace scoped. The Operator Lifecycle Management also provides a subscription, allowing updates to be pulled from various channels. This is similar to the relationship between an RPM and Repository.  After you deploy application via Operator Hub it will launch the operator. Cluster-wide operators will run in the openshift-operators namespace while namespaced operators will only run in a user defined namespace. $ oc get pods -n openshift-operators NAME                               READY   STATUS    RESTARTS   AGE podium-operator-6855dc9478-q65bt   1/1     Running   0          38m Summary In this article we stepped through the process of integrating an already existing operator with the Operator Lifecycle Manager. We saw how to generate an application manifest, build an application catalog bundle, add the bundle to an application index and finally deploy the application catalog, seamlessly integrating with Operator Hub. Using OLM provides not only a way to install applications but manage their lifecycle, releases and updates. Happy Operatoring! (c) 2020 Keith Tenzer">





  <meta name="twitter:site" content="@keithtenzer">
  <meta name="twitter:title" content="OpenShift Operator Lifecycle Management Guide: Integrating Operators in OLM Part IV">
  <meta name="twitter:description" content="Overview In this article we will provide a hands-on guide to integrating your already built Operator with the Operator Lifecycle Manager (OLM). Using the Operator SDK and OPM tool we will create the application manifests and images so your application Operator can be managed through OLM. This article is part of a series that will walk you through understanding and building operators in Go or Ansible end-to-end.  OpenShift Operator Getting Started Part I OpenShift Operator SDK: Go Getting Started Guide Part II OpenShift Operator SDK: Ansible Getting Started Guide Part III OpenShift Operator Lifecycle Management Guide: Integrating Operators in OLM Part IV   In order to add your Operator to OLM you will need two tools: the operator-sdk and opm. Download the binaries for operator-sdk and opm. Install them under /usr/local/bin. Create Cluster Service Version The Cluster Service Version (CSV) is the manifest that allows your application operator to be bundled and exposed to the OLM API. The CSV is itself a CRD in kubernetes. Before creating a the CSV manifest you need the deployment scafolding. These are the objects and CRDs that your Operator require. These are created automatically when using the operator-sdk to create a application under the deploy directory. $ operator-sdk new cars-operator --repo github.com/cars-operator When generating an CSV you will provide the path to the deploy directory where those objects can be found. $ operator-sdk generate csv --csv-version 1.0.0 --deploy-dir deploy The generate csv command will create an olm_catalog/cars-operator/manifests directory. There you will find the &#39;clusterserviceversion&#39; yaml. You will however want to edit and add a lot. As such I have provided an example csv for an Operator I built. Note: If you want to add an icon, so it shows up nicely in Operator Hub, the image needs to be a base64 bit stream inside the csv. $ cat myimage.png | base64 Create Application Operator Catalog Bundle Now that we have generated and updated our CSV we can create an application bundle. $ sudo operator-sdk bundle create quay.io/ktenzer/podium-operator-catalog:latest \ --channels beta --package podium-operator-catalog --directory \ deploy/olm-catalog/podium-operator/manifests This will package the application manifest into a container image. Push the image to a public or private repository. $ sudo docker push quay.io/ktenzer/podium-operator-catalog:latest Create Application Operator Catalog Index Once we have bundled an application operator we can add it to a catalog index. The catalog index provides one or more application bundles to OLM. This is also what the Operator Hub directly interfaces with. $ sudo opm index add -c docker --bundles \ quay.io/ktenzer/podium-operator-catalog:latest \ --tag quay.io/ktenzer/podium-operator-index:latest Again an image is created that needs to be pushed to our private or public repository. $ sudo docker push quay.io/ktenzer/podium-operator-index:latest Deploy Catalog Source A catalog source is a CRD that defines an OLM catalog and points to a catalog index image, for example the one we just created. Create a catalog source yaml file that points to the catalog index image. $ vi catalog_source.yaml apiVersion: operators.coreos.com/v1alpha1 kind: CatalogSource metadata:   name: podium-operator-catalog spec:   sourceType: grpc   image: quay.io/ktenzer/podium-operator-index:latest   displayName: Podium Operator Catalog   publisher: Podium Community Deploy the catalog source under the openshift-marketplace namespace or where you have deployed OLM. $ oc create -f catalog_source.yaml -n openshift-marketplace Below we can see a list of catalogs. Again each catalog can contain one or more applications. All are default in OpenShift, except the one in bold which I added. $ oc get catalogsource -n openshift-marketplace NAME                     DISPLAY                 TYPE PUBLISHER        AGE certified-operators      Certified Operators     grpc Red Hat          18d community-operators      Community Operators     grpc Red Hat          18d podium-operator-catalog  Podium Operator Catalog grpc Podium Community 31m redhat-operators         Red Hat Operators       grpc Red Hat          18d Each catalog has it&#39;s own operator / pod. $ oc get pods -n openshift-marketplace NAME                                    READY   STATUS    RESTARTS   AGE certified-operators-76d9d8b886-bnsz7    1/1     Running   0          14h community-operators-74d675f545-g7d2t    1/1     Running   0          18h podium-operator-catalog-67gsk           1/1     Running   0          31m marketplace-operator-75f49679d7-n7v2r   1/1     Running   0          17d redhat-operators-87d549bf4-mxf7w        1/1     Running   0          13h Once a catalog operator exists, the applications it offers will show up in Operator Hub and can be installed.  Operators can be cluster-wide or namespace scoped. The Operator Lifecycle Management also provides a subscription, allowing updates to be pulled from various channels. This is similar to the relationship between an RPM and Repository.  After you deploy application via Operator Hub it will launch the operator. Cluster-wide operators will run in the openshift-operators namespace while namespaced operators will only run in a user defined namespace. $ oc get pods -n openshift-operators NAME                               READY   STATUS    RESTARTS   AGE podium-operator-6855dc9478-q65bt   1/1     Running   0          38m Summary In this article we stepped through the process of integrating an already existing operator with the Operator Lifecycle Manager. We saw how to generate an application manifest, build an application catalog bundle, add the bundle to an application index and finally deploy the application catalog, seamlessly integrating with Operator Hub. Using OLM provides not only a way to install applications but manage their lifecycle, releases and updates. Happy Operatoring! (c) 2020 Keith Tenzer">
  <meta name="twitter:url" content="http://localhost:4000/openshift/openshift-operator-lifecycle-management-guide-integrating-operators-in-olm-part-iv/">

  
    <meta name="twitter:card" content="summary">
    
  

  



  <meta property="article:published_time" content="2020-04-23T00:00:00-07:00">





  

  


<link rel="canonical" href="http://localhost:4000/openshift/openshift-operator-lifecycle-management-guide-integrating-operators-in-olm-part-iv/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Keith Tenzer",
      "url": "http://localhost:4000/"
    
  }
</script>







<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Keith Tenzer's Blog Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->


    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          Keith Tenzer's Blog
          <span class="site-subtitle">Cloud Computing and Code</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/about/index.html">About</a>
            </li><li class="masthead__menu-item">
              <a href="/conferences-and-events/index.html">Conferences and Events</a>
            </li><li class="masthead__menu-item">
              <a href="/videos/index.html">Videos</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      


  
    



<nav class="breadcrumbs">
  <ol itemscope itemtype="https://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="http://localhost:4000/" itemprop="item"><span itemprop="name">Home</span></a>
          <meta itemprop="position" content="1" />
        </li>
        <span class="sep">/</span>
      
      
        
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="/categories/#openshift" itemprop="item"><span itemprop="name">Openshift</span></a>
          <meta itemprop="position" content="2" />
        </li>
        <span class="sep">/</span>
      
    
      
      
        <li class="current">OpenShift Operator Lifecycle Management Guide: Integrating Operators in OLM Part IV</li>
      
    
  </ol>
</nav>

  


<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/assets/main/me.png" alt="Keith Tenzer" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Keith Tenzer</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>Solutions Architect at Temporal</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Los Angeles, CA</span>
        </li>
      

      
        
          
        
          
        
          
            <li><a href="https://twitter.com/keithtenzer" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
          
        
          
        
          
            <li><a href="https://github.com/ktenzer" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="OpenShift Operator Lifecycle Management Guide: Integrating Operators in OLM Part IV">
    <meta itemprop="description" content="OverviewIn this article we will provide a hands-on guide to integrating your already built Operator with the Operator Lifecycle Manager (OLM). Using the Operator SDK and OPM tool we will create the application manifests and images so your application Operator can be managed through OLM.This article is part of a series that will walk you through understanding and building operators in Go or Ansible end-to-end.OpenShift Operator Getting Started Part IOpenShift Operator SDK: Go Getting Started Guide Part IIOpenShift Operator SDK: Ansible Getting Started Guide Part IIIOpenShift Operator Lifecycle Management Guide: Integrating Operators in OLM Part IVIn order to add your Operator to OLM you will need two tools: the operator-sdk and opm. Download the binaries for operator-sdk and opm. Install them under /usr/local/bin.Create Cluster Service VersionThe Cluster Service Version (CSV) is the manifest that allows your application operator to be bundled and exposed to the OLM API. The CSV is itself a CRD in kubernetes. Before creating a the CSV manifest you need the deployment scafolding. These are the objects and CRDs that your Operator require. These are created automatically when using the operator-sdk to create a application under the deploy directory.$ operator-sdk new cars-operator --repo github.com/cars-operatorWhen generating an CSV you will provide the path to the deploy directory where those objects can be found.$ operator-sdk generate csv --csv-version 1.0.0 --deploy-dir deployThe generate csv command will create an olm_catalog/cars-operator/manifests directory. There you will find the &#39;clusterserviceversion&#39; yaml. You will however want to edit and add a lot. As such I have provided an example csv for an Operator I built.Note: If you want to add an icon, so it shows up nicely in Operator Hub, the image needs to be a base64 bit stream inside the csv.$ cat myimage.png | base64Create Application Operator Catalog BundleNow that we have generated and updated our CSV we can create an application bundle.$ sudo operator-sdk bundle create quay.io/ktenzer/podium-operator-catalog:latest \--channels beta --package podium-operator-catalog --directory \deploy/olm-catalog/podium-operator/manifestsThis will package the application manifest into a container image. Push the image to a public or private repository.$ sudo docker push quay.io/ktenzer/podium-operator-catalog:latestCreate Application Operator Catalog IndexOnce we have bundled an application operator we can add it to a catalog index. The catalog index provides one or more application bundles to OLM. This is also what the Operator Hub directly interfaces with.$ sudo opm index add -c docker --bundles \quay.io/ktenzer/podium-operator-catalog:latest \--tag quay.io/ktenzer/podium-operator-index:latestAgain an image is created that needs to be pushed to our private or public repository.$ sudo docker push quay.io/ktenzer/podium-operator-index:latestDeploy Catalog SourceA catalog source is a CRD that defines an OLM catalog and points to a catalog index image, for example the one we just created.Create a catalog source yaml file that points to the catalog index image.$ vi catalog_source.yamlapiVersion: operators.coreos.com/v1alpha1kind: CatalogSourcemetadata:  name: podium-operator-catalogspec:  sourceType: grpc  image: quay.io/ktenzer/podium-operator-index:latest  displayName: Podium Operator Catalog  publisher: Podium CommunityDeploy the catalog source under the openshift-marketplace namespace or where you have deployed OLM.$ oc create -f catalog_source.yaml -n openshift-marketplaceBelow we can see a list of catalogs. Again each catalog can contain one or more applications. All are default in OpenShift, except the one in bold which I added.$ oc get catalogsource -n openshift-marketplaceNAME                     DISPLAY                 TYPE PUBLISHER        AGEcertified-operators      Certified Operators     grpc Red Hat          18dcommunity-operators      Community Operators     grpc Red Hat          18dpodium-operator-catalog  Podium Operator Catalog grpc Podium Community 31mredhat-operators         Red Hat Operators       grpc Red Hat          18dEach catalog has it&#39;s own operator / pod.$ oc get pods -n openshift-marketplaceNAME                                    READY   STATUS    RESTARTS   AGEcertified-operators-76d9d8b886-bnsz7    1/1     Running   0          14hcommunity-operators-74d675f545-g7d2t    1/1     Running   0          18hpodium-operator-catalog-67gsk           1/1     Running   0          31mmarketplace-operator-75f49679d7-n7v2r   1/1     Running   0          17dredhat-operators-87d549bf4-mxf7w        1/1     Running   0          13hOnce a catalog operator exists, the applications it offers will show up in Operator Hub and can be installed.Operators can be cluster-wide or namespace scoped. The Operator Lifecycle Management also provides a subscription, allowing updates to be pulled from various channels. This is similar to the relationship between an RPM and Repository.After you deploy application via Operator Hub it will launch the operator. Cluster-wide operators will run in the openshift-operators namespace while namespaced operators will only run in a user defined namespace.$ oc get pods -n openshift-operatorsNAME                               READY   STATUS    RESTARTS   AGEpodium-operator-6855dc9478-q65bt   1/1     Running   0          38mSummaryIn this article we stepped through the process of integrating an already existing operator with the Operator Lifecycle Manager. We saw how to generate an application manifest, build an application catalog bundle, add the bundle to an application index and finally deploy the application catalog, seamlessly integrating with Operator Hub. Using OLM provides not only a way to install applications but manage their lifecycle, releases and updates.Happy Operatoring!(c) 2020 Keith Tenzer">
    <meta itemprop="datePublished" content="2020-04-23T00:00:00-07:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">OpenShift Operator Lifecycle Management Guide: Integrating Operators in OLM Part IV
</h1>
          

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2020-04-23T00:00:00-07:00">April 23, 2020</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          8 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
        <h2><img class="alignnone  wp-image-14443" src="/assets/2020/04/38202270.png?w=173&amp;h=173" alt="38202270" width="173" height="173" /></h2>
<h2>Overview</h2>
<p>In this article we will provide a hands-on guide to integrating your already built Operator with the Operator Lifecycle Manager (OLM). Using the Operator SDK and OPM tool we will create the application manifests and images so your application Operator can be managed through OLM.</p>
<p>This article is part of a series that will walk you through understanding and building operators in Go or Ansible end-to-end.</p>
<ul>
<li><a href="https://keithtenzer.com/2020/04/23/openshift-operator-getting-started-part-i/">OpenShift Operator Getting Started Part I</a></li>
<li><a href="https://keithtenzer.com/2020/01/27/openshift-operator-sdk-go-getting-started-guide-part-ii/">OpenShift Operator SDK: Go Getting Started Guide Part II</a></li>
<li><a href="https://keithtenzer.com/2020/04/23/openshift-operator-sdk-ansible-getting-started-guide-part-iii/">OpenShift Operator SDK: Ansible Getting Started Guide Part III</a></li>
<li><a href="https://keithtenzer.com/2020/04/23/openshift-operator-lifecycle-management-guide-integrating-operators-in-olm-part-iv/">OpenShift Operator Lifecycle Management Guide: Integrating Operators in OLM Part IV</a></li>
</ul>
<p><!--more--></p>
<p>In order to add your Operator to OLM you will need two tools: the <a href="https://github.com/operator-framework/operator-sdk/releases">operator-sdk</a> and <a href="https://github.com/operator-framework/operator-registry/releases">opm</a>. Download the binaries for operator-sdk and opm. Install them under /usr/local/bin.</p>
<h2>Create Cluster Service Version</h2>
<p>The Cluster Service Version (CSV) is the manifest that allows your application operator to be bundled and exposed to the OLM API. The CSV is itself a CRD in kubernetes. Before creating a the CSV manifest you need the deployment scafolding. These are the objects and CRDs that your Operator require. These are created automatically when using the operator-sdk to create a application under the deploy directory.</p>
<pre>$ operator-sdk new cars-operator --repo github.com/cars-operator</pre>
<p>When generating an CSV you will provide the path to the deploy directory where those objects can be found.</p>
<pre>$ operator-sdk generate csv --csv-version 1.0.0 --deploy-dir deploy</pre>
<p>The generate csv command will create an olm_catalog/cars-operator/manifests directory. There you will find the 'clusterserviceversion' yaml. You will however want to edit and add a lot. As such I have provided an <a href="https://github.com/sa-mw-dach/podium/blob/master/podium-operator/deploy/olm-catalog/podium-operator/manifests/podium-operator.clusterserviceversion.yaml">example</a> csv for an Operator I built.</p>
<p>Note: If you want to add an icon, so it shows up nicely in Operator Hub, the image needs to be a base64 bit stream inside the csv.</p>
<pre>$ cat myimage.png | base64</pre>
<h2>Create Application Operator Catalog Bundle</h2>
<p>Now that we have generated and updated our CSV we can create an application bundle.</p>
<pre>$ sudo operator-sdk bundle create quay.io/ktenzer/podium-operator-catalog:latest \
--channels beta --package podium-operator-catalog --directory \
deploy/olm-catalog/podium-operator/manifests</pre>
<p>This will package the application manifest into a container image. Push the image to a public or private repository.</p>
<pre>$ sudo docker push quay.io/ktenzer/podium-operator-catalog:latest</pre>
<h2>Create Application Operator Catalog Index</h2>
<p>Once we have bundled an application operator we can add it to a catalog index. The catalog index provides one or more application bundles to OLM. This is also what the Operator Hub directly interfaces with.</p>
<pre>$ sudo opm index add -c docker --bundles \
quay.io/ktenzer/podium-operator-catalog:latest \
--tag quay.io/ktenzer/podium-operator-index:latest</pre>
<p>Again an image is created that needs to be pushed to our private or public repository.</p>
<pre>$ sudo docker push quay.io/ktenzer/podium-operator-index:latest</pre>
<h2>Deploy Catalog Source</h2>
<p>A catalog source is a CRD that defines an OLM catalog and points to a catalog index image, for example the one we just created.</p>
<p>Create a catalog source yaml file that points to the catalog index image.</p>
<pre>$ vi catalog_source.yaml
apiVersion: operators.coreos.com/v1alpha1
kind: CatalogSource
metadata:
  name: podium-operator-catalog
spec:
  sourceType: grpc
  <strong>image: quay.io/ktenzer/podium-operator-index:latest</strong>
  displayName: Podium Operator Catalog
  publisher: Podium Community</pre>
<p>Deploy the catalog source under the openshift-marketplace namespace or where you have deployed OLM.</p>
<pre>$ oc create -f catalog_source.yaml -n openshift-marketplace</pre>
<p>Below we can see a list of catalogs. Again each catalog can contain one or more applications. All are default in OpenShift, except the one in bold which I added.</p>
<pre>$ oc get catalogsource -n openshift-marketplace
NAME                     DISPLAY                 TYPE PUBLISHER        AGE
certified-operators      Certified Operators     grpc Red Hat          18d
community-operators      Community Operators     grpc Red Hat          18d
<strong>podium-operator-catalog  Podium Operator Catalog grpc Podium Community 31m</strong>
redhat-operators         Red Hat Operators       grpc Red Hat          18d</pre>
<p>Each catalog has it's own operator / pod.</p>
<pre>$ oc get pods -n openshift-marketplace
NAME                                    READY   STATUS    RESTARTS   AGE
certified-operators-76d9d8b886-bnsz7    1/1     Running   0          14h
community-operators-74d675f545-g7d2t    1/1     Running   0          18h
<strong>podium-operator-catalog-67gsk           1/1     Running   0          31m</strong>
marketplace-operator-75f49679d7-n7v2r   1/1     Running   0          17d
redhat-operators-87d549bf4-mxf7w        1/1     Running   0          13h</pre>
<p>Once a catalog operator exists, the applications it offers will show up in Operator Hub and can be installed.</p>
<p><img class="alignnone size-full wp-image-14528" src="/assets/2020/04/podium_install.png" alt="podium_install" width="1094" height="828" /></p>
<p>Operators can be cluster-wide or namespace scoped. The Operator Lifecycle Management also provides a subscription, allowing updates to be pulled from various channels. This is similar to the relationship between an RPM and Repository.</p>
<p><img class="alignnone size-full wp-image-14529" src="/assets/2020/04/podium_install2.png" alt="podium_install2" width="792" height="743" /></p>
<p>After you deploy application via Operator Hub it will launch the operator. Cluster-wide operators will run in the openshift-operators namespace while namespaced operators will only run in a user defined namespace.</p>
<pre>$ oc get pods -n openshift-operators
NAME                               READY   STATUS    RESTARTS   AGE
podium-operator-6855dc9478-q65bt   1/1     Running   0          38m</pre>
<h2>Summary</h2>
<p>In this article we stepped through the process of integrating an already existing operator with the Operator Lifecycle Manager. We saw how to generate an application manifest, build an application catalog bundle, add the bundle to an application index and finally deploy the application catalog, seamlessly integrating with Operator Hub. Using OLM provides not only a way to install applications but manage their lifecycle, releases and updates.</p>
<p>Happy Operatoring!</p>
<p>(c) 2020 Keith Tenzer</p>

        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/#containers" class="page__taxonomy-item" rel="tag">Containers</a><span class="sep">, </span>
    
      <a href="/tags/#kubernetes" class="page__taxonomy-item" rel="tag">Kubernetes</a><span class="sep">, </span>
    
      <a href="/tags/#olm" class="page__taxonomy-item" rel="tag">olm</a><span class="sep">, </span>
    
      <a href="/tags/#openshift" class="page__taxonomy-item" rel="tag">OpenShift</a><span class="sep">, </span>
    
      <a href="/tags/#operator" class="page__taxonomy-item" rel="tag">Operator</a><span class="sep">, </span>
    
      <a href="/tags/#operator-lifecycle-management" class="page__taxonomy-item" rel="tag">Operator Lifecycle Management</a><span class="sep">, </span>
    
      <a href="/tags/#operator-sdk" class="page__taxonomy-item" rel="tag">operator-sdk</a>
    
    </span>
  </p>




  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      <a href="/categories/#openshift" class="page__taxonomy-item" rel="tag">OpenShift</a>
    
    </span>
  </p>


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2020-04-23T00:00:00-07:00">April 23, 2020</time></p>


      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?via=keithtenzer&text=OpenShift+Operator+Lifecycle+Management+Guide%3A+Integrating+Operators+in+OLM+Part+IV%20http%3A%2F%2Flocalhost%3A4000%2Fopenshift%2Fopenshift-operator-lifecycle-management-guide-integrating-operators-in-olm-part-iv%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2Fopenshift%2Fopenshift-operator-lifecycle-management-guide-integrating-operators-in-olm-part-iv%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2Fopenshift%2Fopenshift-operator-lifecycle-management-guide-integrating-operators-in-olm-part-iv%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/openshift/openshift-operator-getting-started-part-i/" class="pagination--pager" title="OpenShift Operator Getting Started Part I
">Previous</a>
    
    
      <a href="/openshift/openshift-operator-sdk-ansible-getting-started-guide-part-iii/" class="pagination--pager" title="OpenShift Operator SDK: Ansible Getting Started Guide Part III
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You may also enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/temporal/temporal_getting_started_guide/" rel="permalink">Temporal Getting Started Guide
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2022-08-24T00:00:00-07:00">August 24, 2022</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          7 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
Overview
In this article we will walk through setup of a development environment for Temporal. There are of course, several ways you can run the Temporal se...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/temporal/my-first-day-at-temporal/" rel="permalink">My First Day at Temporal
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2022-08-15T00:00:00-07:00">August 15, 2022</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          9 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
Overview
Today is my first day at temporal and with that I wanted to share some thoughts around my decision, why Temporal and my experience thus far. As you...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/linux/blog-with-gitops-practices-and-github/" rel="permalink">Blog with Gitops Practices and GitHub
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2022-02-10T00:00:00-08:00">February 10, 2022</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          13 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Overview
Want to build your brand, while living the gitops revolution and not paying anything for it? That is exactly what this article will walk you through...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/linux/The-Fedora-Workstation-Experience/" rel="permalink">The Fedora Workstation Experience
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2022-01-10T00:00:00-08:00">January 10, 2022</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          10 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
Overview
A lot of people always ask me what is the best way to contribute to opensource? Of course contributing code, documentation, spreading the gospel or...</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
          <li><a href="https://twitter.com/keithtenzer"" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
        
      
        
      
        
          <li><a href="https://github.com/ktenzer" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
      
        
      
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2022 Keith Tenzer. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>







  </body>
</html>
