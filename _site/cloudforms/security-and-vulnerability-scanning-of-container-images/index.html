<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.22.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Security and Vulnerability Scanning of Container Images - KEITHTENZER.COM</title>
<meta name="description" content="Overview In this article we will focus on security and vulnerability strategies for scanning container images. I know, in the past security was always viewed upon as an impedance to the speed of production but hopefully these days are behind us. Having a security breach, as you probably know, is one of the most costly things an organization can endure. It takes years to build up a reputation and only seconds to tear it down completely. I still see today, many organizations ignoring container images completely because it is often misunderstood. Exactly what is inside a container image? Who should be responsible for it? How does it map to what we have done on servers? Security teams often don&#39;t understand containers or even know what questions to ask. We need to help them and it is our duty to do so. Unfortunately there are not very many tools that can help in broad sense. Containers are new and evolving at breakneck speed. That coupled with the fact that security can negatively impact the speed of a DevOps team (if not done right), it is no wonder we are at square one, in many cases. Before we dive into more detail, let us review important security aspects of containers.  Containers can have various packaging formats, Docker is the most popular today Containers are immutable and as such are image based Container are never updated, any change always results in a new container Container images consist of layers (base, runtime, application) Container images require shared responsibility between dev and ops Containers don&#39;t contain, they are in fact, just processes  For more information I recommend reading about the 10 layers of container security.  Container images contain OS, runtime and application (everything but the Linux kernel basically). If a container is breached, there is not much in the way preventing further containers from being breached unless you have SELinux, limit kernel capabilities, run as non-priviledged user and follow many other best practices. OpenShift and using trusted, signed images by a vendor like Red Hat does all of this by default. Even still the attack surface can be large. You still think it is OK to not worry about container images and what is inside? Thankfully there are at least several solutions we will talk about from Red Hat for the container Platform OpenShift.  Container Catalog grades images provided by Red Hat and provides history of image as security patches are applied. Atomic CLI scans images and uses OpenSCAP to determine security vulnerabilities. CloudForms scans images using OpenSCAP (same as atomic) and also adds capabilities like taking action when container images are vulnerable, automatically scanning new images and even reporting.  All of these solutions are included with OpenShift. Container Catalog Red Hat offers a container catalog for all images that it provides. Images are maintained by Red Hat meaning they are frequently scanned and updated. The container catalog also provides the history of an image, each time it is updated a new tag is created. The image is graded according to a scale A to F.       Health Index Security Errata Conditions   Grade A  This image does not have any unapplied Critical or Important security errata   Grade B  This image is affected by Critical (no older than 7 days) or Important (no older than 30 days) security errata   Grade C  This image is affected by Critical (no older than 30 days) or Important (no older than 90 days) security errata   Grade D  This image is affected by Critical (no older than 90 days) or Important (no older than 12 months) security errata   Grade E  This image is affected by Critical or Important security errata no older than 12 months   Grade F  This image is affected by Critical or Important security errata older than 12 months   Unknown This image is missing metadata required to calculate a grade and cannot be scanned    Check image (example nodejs-6). https://access.redhat.com/containers/?tab=overview&amp;platform=openshift#/registry.access.redhat.com/rhscl/nodejs-6-rhel7  We see the image has a health index of A and is also signed. We also see it runs as unprivileged user. View Image History Under tags, the history of the image can be viewed.  Image Details By clicking on the tag name we are able to get more detail about a given image.  Any CVEs that affect the image are shown in addition to RPM advisory. Atomic CLI Image Scanning Atomic Cli provides image scanning using OpenSCAP. This tool can be used via Ansible or other automation in CI/CD pipeline to automatically scan images. Install Atomic cli If you aren&#39;t running RHEL Atomic you need to install the atomic cli. In this case we are doing so on the OpenShift master (master0) but it can be any node that has access to the container images. If image doesn&#39;t exist locally (in this case on master0) it must be pulled down. [master0 ~]$ yum install -y atomic Get the image that should be scanned [master0 ~]$ oc get image |grep nodejs sha256:947bf778fd9ee31a4cd06a702954aa0cd91e1eb81fef366a9080c0cfe3e35e43 172.30.187.230:5000/mynodejs/test@sha256:947bf778fd9ee31a4cd06a702954aa0cd91e1eb81fef366a9080c0cfe3e35e43 sha256:a9b89bb53fef405ea73f3eaff2dafa0c37c2cc988586b1a8a0e3bc19de07d4b8 registry.access.redhat.com/rhscl/nodejs-6-rhel7@sha256:a9b89bb53fef405ea73f3eaff2dafa0c37c2cc988586b1a8a0e3bc19de07d4b8 sha256:b6fee5146e6330e9890f8290746944ab1452f709f806588fbfb1ff5cadb5aaed registry.access.redhat.com/rhscl/nodejs-4-rhel7@sha256:b6fee5146e6330e9890f8290746944ab1452f709f806588fbfb1ff5cadb5aaed sha256:c17fa1ffa8e4acf5e66e10127aea2ae5ca3eda7c34aecc005aaf3b04da48814c 172.30.187.230:5000/mynodejs/nodejs-hello-world-v2@sha256:c17fa1ffa8e4acf5e66e10127aea2ae5ca3eda7c34aecc005aaf3b04da48814c">


  <meta name="author" content="Keith Tenzer">
  
  <meta property="article:author" content="Keith Tenzer">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="KEITHTENZER.COM">
<meta property="og:title" content="Security and Vulnerability Scanning of Container Images">
<meta property="og:url" content="https://keithtenzer.com/cloudforms/security-and-vulnerability-scanning-of-container-images/">


  <meta property="og:description" content="Overview In this article we will focus on security and vulnerability strategies for scanning container images. I know, in the past security was always viewed upon as an impedance to the speed of production but hopefully these days are behind us. Having a security breach, as you probably know, is one of the most costly things an organization can endure. It takes years to build up a reputation and only seconds to tear it down completely. I still see today, many organizations ignoring container images completely because it is often misunderstood. Exactly what is inside a container image? Who should be responsible for it? How does it map to what we have done on servers? Security teams often don&#39;t understand containers or even know what questions to ask. We need to help them and it is our duty to do so. Unfortunately there are not very many tools that can help in broad sense. Containers are new and evolving at breakneck speed. That coupled with the fact that security can negatively impact the speed of a DevOps team (if not done right), it is no wonder we are at square one, in many cases. Before we dive into more detail, let us review important security aspects of containers.  Containers can have various packaging formats, Docker is the most popular today Containers are immutable and as such are image based Container are never updated, any change always results in a new container Container images consist of layers (base, runtime, application) Container images require shared responsibility between dev and ops Containers don&#39;t contain, they are in fact, just processes  For more information I recommend reading about the 10 layers of container security.  Container images contain OS, runtime and application (everything but the Linux kernel basically). If a container is breached, there is not much in the way preventing further containers from being breached unless you have SELinux, limit kernel capabilities, run as non-priviledged user and follow many other best practices. OpenShift and using trusted, signed images by a vendor like Red Hat does all of this by default. Even still the attack surface can be large. You still think it is OK to not worry about container images and what is inside? Thankfully there are at least several solutions we will talk about from Red Hat for the container Platform OpenShift.  Container Catalog grades images provided by Red Hat and provides history of image as security patches are applied. Atomic CLI scans images and uses OpenSCAP to determine security vulnerabilities. CloudForms scans images using OpenSCAP (same as atomic) and also adds capabilities like taking action when container images are vulnerable, automatically scanning new images and even reporting.  All of these solutions are included with OpenShift. Container Catalog Red Hat offers a container catalog for all images that it provides. Images are maintained by Red Hat meaning they are frequently scanned and updated. The container catalog also provides the history of an image, each time it is updated a new tag is created. The image is graded according to a scale A to F.       Health Index Security Errata Conditions   Grade A  This image does not have any unapplied Critical or Important security errata   Grade B  This image is affected by Critical (no older than 7 days) or Important (no older than 30 days) security errata   Grade C  This image is affected by Critical (no older than 30 days) or Important (no older than 90 days) security errata   Grade D  This image is affected by Critical (no older than 90 days) or Important (no older than 12 months) security errata   Grade E  This image is affected by Critical or Important security errata no older than 12 months   Grade F  This image is affected by Critical or Important security errata older than 12 months   Unknown This image is missing metadata required to calculate a grade and cannot be scanned    Check image (example nodejs-6). https://access.redhat.com/containers/?tab=overview&amp;platform=openshift#/registry.access.redhat.com/rhscl/nodejs-6-rhel7  We see the image has a health index of A and is also signed. We also see it runs as unprivileged user. View Image History Under tags, the history of the image can be viewed.  Image Details By clicking on the tag name we are able to get more detail about a given image.  Any CVEs that affect the image are shown in addition to RPM advisory. Atomic CLI Image Scanning Atomic Cli provides image scanning using OpenSCAP. This tool can be used via Ansible or other automation in CI/CD pipeline to automatically scan images. Install Atomic cli If you aren&#39;t running RHEL Atomic you need to install the atomic cli. In this case we are doing so on the OpenShift master (master0) but it can be any node that has access to the container images. If image doesn&#39;t exist locally (in this case on master0) it must be pulled down. [master0 ~]$ yum install -y atomic Get the image that should be scanned [master0 ~]$ oc get image |grep nodejs sha256:947bf778fd9ee31a4cd06a702954aa0cd91e1eb81fef366a9080c0cfe3e35e43 172.30.187.230:5000/mynodejs/test@sha256:947bf778fd9ee31a4cd06a702954aa0cd91e1eb81fef366a9080c0cfe3e35e43 sha256:a9b89bb53fef405ea73f3eaff2dafa0c37c2cc988586b1a8a0e3bc19de07d4b8 registry.access.redhat.com/rhscl/nodejs-6-rhel7@sha256:a9b89bb53fef405ea73f3eaff2dafa0c37c2cc988586b1a8a0e3bc19de07d4b8 sha256:b6fee5146e6330e9890f8290746944ab1452f709f806588fbfb1ff5cadb5aaed registry.access.redhat.com/rhscl/nodejs-4-rhel7@sha256:b6fee5146e6330e9890f8290746944ab1452f709f806588fbfb1ff5cadb5aaed sha256:c17fa1ffa8e4acf5e66e10127aea2ae5ca3eda7c34aecc005aaf3b04da48814c 172.30.187.230:5000/mynodejs/nodejs-hello-world-v2@sha256:c17fa1ffa8e4acf5e66e10127aea2ae5ca3eda7c34aecc005aaf3b04da48814c">





  <meta name="twitter:site" content="@keithtenzer">
  <meta name="twitter:title" content="Security and Vulnerability Scanning of Container Images">
  <meta name="twitter:description" content="Overview In this article we will focus on security and vulnerability strategies for scanning container images. I know, in the past security was always viewed upon as an impedance to the speed of production but hopefully these days are behind us. Having a security breach, as you probably know, is one of the most costly things an organization can endure. It takes years to build up a reputation and only seconds to tear it down completely. I still see today, many organizations ignoring container images completely because it is often misunderstood. Exactly what is inside a container image? Who should be responsible for it? How does it map to what we have done on servers? Security teams often don&#39;t understand containers or even know what questions to ask. We need to help them and it is our duty to do so. Unfortunately there are not very many tools that can help in broad sense. Containers are new and evolving at breakneck speed. That coupled with the fact that security can negatively impact the speed of a DevOps team (if not done right), it is no wonder we are at square one, in many cases. Before we dive into more detail, let us review important security aspects of containers.  Containers can have various packaging formats, Docker is the most popular today Containers are immutable and as such are image based Container are never updated, any change always results in a new container Container images consist of layers (base, runtime, application) Container images require shared responsibility between dev and ops Containers don&#39;t contain, they are in fact, just processes  For more information I recommend reading about the 10 layers of container security.  Container images contain OS, runtime and application (everything but the Linux kernel basically). If a container is breached, there is not much in the way preventing further containers from being breached unless you have SELinux, limit kernel capabilities, run as non-priviledged user and follow many other best practices. OpenShift and using trusted, signed images by a vendor like Red Hat does all of this by default. Even still the attack surface can be large. You still think it is OK to not worry about container images and what is inside? Thankfully there are at least several solutions we will talk about from Red Hat for the container Platform OpenShift.  Container Catalog grades images provided by Red Hat and provides history of image as security patches are applied. Atomic CLI scans images and uses OpenSCAP to determine security vulnerabilities. CloudForms scans images using OpenSCAP (same as atomic) and also adds capabilities like taking action when container images are vulnerable, automatically scanning new images and even reporting.  All of these solutions are included with OpenShift. Container Catalog Red Hat offers a container catalog for all images that it provides. Images are maintained by Red Hat meaning they are frequently scanned and updated. The container catalog also provides the history of an image, each time it is updated a new tag is created. The image is graded according to a scale A to F.       Health Index Security Errata Conditions   Grade A  This image does not have any unapplied Critical or Important security errata   Grade B  This image is affected by Critical (no older than 7 days) or Important (no older than 30 days) security errata   Grade C  This image is affected by Critical (no older than 30 days) or Important (no older than 90 days) security errata   Grade D  This image is affected by Critical (no older than 90 days) or Important (no older than 12 months) security errata   Grade E  This image is affected by Critical or Important security errata no older than 12 months   Grade F  This image is affected by Critical or Important security errata older than 12 months   Unknown This image is missing metadata required to calculate a grade and cannot be scanned    Check image (example nodejs-6). https://access.redhat.com/containers/?tab=overview&amp;platform=openshift#/registry.access.redhat.com/rhscl/nodejs-6-rhel7  We see the image has a health index of A and is also signed. We also see it runs as unprivileged user. View Image History Under tags, the history of the image can be viewed.  Image Details By clicking on the tag name we are able to get more detail about a given image.  Any CVEs that affect the image are shown in addition to RPM advisory. Atomic CLI Image Scanning Atomic Cli provides image scanning using OpenSCAP. This tool can be used via Ansible or other automation in CI/CD pipeline to automatically scan images. Install Atomic cli If you aren&#39;t running RHEL Atomic you need to install the atomic cli. In this case we are doing so on the OpenShift master (master0) but it can be any node that has access to the container images. If image doesn&#39;t exist locally (in this case on master0) it must be pulled down. [master0 ~]$ yum install -y atomic Get the image that should be scanned [master0 ~]$ oc get image |grep nodejs sha256:947bf778fd9ee31a4cd06a702954aa0cd91e1eb81fef366a9080c0cfe3e35e43 172.30.187.230:5000/mynodejs/test@sha256:947bf778fd9ee31a4cd06a702954aa0cd91e1eb81fef366a9080c0cfe3e35e43 sha256:a9b89bb53fef405ea73f3eaff2dafa0c37c2cc988586b1a8a0e3bc19de07d4b8 registry.access.redhat.com/rhscl/nodejs-6-rhel7@sha256:a9b89bb53fef405ea73f3eaff2dafa0c37c2cc988586b1a8a0e3bc19de07d4b8 sha256:b6fee5146e6330e9890f8290746944ab1452f709f806588fbfb1ff5cadb5aaed registry.access.redhat.com/rhscl/nodejs-4-rhel7@sha256:b6fee5146e6330e9890f8290746944ab1452f709f806588fbfb1ff5cadb5aaed sha256:c17fa1ffa8e4acf5e66e10127aea2ae5ca3eda7c34aecc005aaf3b04da48814c 172.30.187.230:5000/mynodejs/nodejs-hello-world-v2@sha256:c17fa1ffa8e4acf5e66e10127aea2ae5ca3eda7c34aecc005aaf3b04da48814c">
  <meta name="twitter:url" content="https://keithtenzer.com/cloudforms/security-and-vulnerability-scanning-of-container-images/">

  
    <meta name="twitter:card" content="summary">
    
  

  



  <meta property="article:published_time" content="2018-02-16T00:00:00-08:00">





  

  


<link rel="canonical" href="https://keithtenzer.com/cloudforms/security-and-vulnerability-scanning-of-container-images/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Keith Tenzer",
      "url": "https://keithtenzer.com/"
    
  }
</script>







<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="KEITHTENZER.COM Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->


    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          KEITHTENZER.COM
          <span class="site-subtitle">Cloud Computing and Code</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/about/index.html">About</a>
            </li><li class="masthead__menu-item">
              <a href="/conferences-and-events/index.html">Conferences and Events</a>
            </li><li class="masthead__menu-item">
              <a href="/videos/index.html">Videos</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      


  
    



<nav class="breadcrumbs">
  <ol itemscope itemtype="https://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="https://keithtenzer.com/" itemprop="item"><span itemprop="name">Home</span></a>
          <meta itemprop="position" content="1" />
        </li>
        <span class="sep">/</span>
      
      
        
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="/categories/#cloudforms" itemprop="item"><span itemprop="name">Cloudforms</span></a>
          <meta itemprop="position" content="2" />
        </li>
        <span class="sep">/</span>
      
    
      
      
        <li class="current">Security and Vulnerability Scanning of Container Images</li>
      
    
  </ol>
</nav>

  


<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/assets/main/me.png" alt="Keith Tenzer" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Keith Tenzer</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>Principal Solutions Architect at Red Hat</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Los Angeles, CA</span>
        </li>
      

      
        
          
        
          
        
          
            <li><a href="https://twitter.com/keithtenzer" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
          
        
          
        
          
            <li><a href="https://github.com/ktenzer" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Security and Vulnerability Scanning of Container Images">
    <meta itemprop="description" content="OverviewIn this article we will focus on security and vulnerability strategies for scanning container images. I know, in the past security was always viewed upon as an impedance to the speed of production but hopefully these days are behind us. Having a security breach, as you probably know, is one of the most costly things an organization can endure. It takes years to build up a reputation and only seconds to tear it down completely.I still see today, many organizations ignoring container images completely because it is often misunderstood. Exactly what is inside a container image? Who should be responsible for it? How does it map to what we have done on servers? Security teams often don&#39;t understand containers or even know what questions to ask. We need to help them and it is our duty to do so. Unfortunately there are not very many tools that can help in broad sense. Containers are new and evolving at breakneck speed. That coupled with the fact that security can negatively impact the speed of a DevOps team (if not done right), it is no wonder we are at square one, in many cases.Before we dive into more detail, let us review important security aspects of containers.Containers can have various packaging formats, Docker is the most popular todayContainers are immutable and as such are image basedContainer are never updated, any change always results in a new containerContainer images consist of layers (base, runtime, application)Container images require shared responsibility between dev and opsContainers don&#39;t contain, they are in fact, just processesFor more information I recommend reading about the 10 layers of container security.Container images contain OS, runtime and application (everything but the Linux kernel basically). If a container is breached, there is not much in the way preventing further containers from being breached unless you have SELinux, limit kernel capabilities, run as non-priviledged user and follow many other best practices. OpenShift and using trusted, signed images by a vendor like Red Hat does all of this by default. Even still the attack surface can be large. You still think it is OK to not worry about container images and what is inside? Thankfully there are at least several solutions we will talk about from Red Hat for the container Platform OpenShift.Container Catalog grades images provided by Red Hat and provides history of image as security patches are applied.Atomic CLI scans images and uses OpenSCAP to determine security vulnerabilities.CloudForms scans images using OpenSCAP (same as atomic) and also adds capabilities like taking action when container images are vulnerable, automatically scanning new images and even reporting.All of these solutions are included with OpenShift.Container CatalogRed Hat offers a container catalog for all images that it provides. Images are maintained by Red Hat meaning they are frequently scanned and updated. The container catalog also provides the history of an image, each time it is updated a new tag is created. The image is graded according to a scale A to F.Health IndexSecurity Errata ConditionsGrade A This image does not have any unapplied Critical or Important security errataGrade B This image is affected by Critical (no older than 7 days) or Important (no older than 30 days) security errataGrade C This image is affected by Critical (no older than 30 days) or Important (no older than 90 days) security errataGrade D This image is affected by Critical (no older than 90 days) or Important (no older than 12 months) security errataGrade E This image is affected by Critical or Important security errata no older than 12 monthsGrade F This image is affected by Critical or Important security errata older than 12 monthsUnknownThis image is missing metadata required to calculate a grade and cannot be scannedCheck image (example nodejs-6).https://access.redhat.com/containers/?tab=overview&amp;platform=openshift#/registry.access.redhat.com/rhscl/nodejs-6-rhel7We see the image has a health index of A and is also signed. We also see it runs as unprivileged user.View Image HistoryUnder tags, the history of the image can be viewed.Image DetailsBy clicking on the tag name we are able to get more detail about a given image.Any CVEs that affect the image are shown in addition to RPM advisory.Atomic CLI Image ScanningAtomic Cli provides image scanning using OpenSCAP. This tool can be used via Ansible or other automation in CI/CD pipeline to automatically scan images.Install Atomic cliIf you aren&#39;t running RHEL Atomic you need to install the atomic cli. In this case we are doing so on the OpenShift master (master0) but it can be any node that has access to the container images. If image doesn&#39;t exist locally (in this case on master0) it must be pulled down.[master0 ~]$ yum install -y atomicGet the image that should be scanned[master0 ~]$ oc get image |grep nodejssha256:947bf778fd9ee31a4cd06a702954aa0cd91e1eb81fef366a9080c0cfe3e35e43 172.30.187.230:5000/mynodejs/test@sha256:947bf778fd9ee31a4cd06a702954aa0cd91e1eb81fef366a9080c0cfe3e35e43sha256:a9b89bb53fef405ea73f3eaff2dafa0c37c2cc988586b1a8a0e3bc19de07d4b8 registry.access.redhat.com/rhscl/nodejs-6-rhel7@sha256:a9b89bb53fef405ea73f3eaff2dafa0c37c2cc988586b1a8a0e3bc19de07d4b8sha256:b6fee5146e6330e9890f8290746944ab1452f709f806588fbfb1ff5cadb5aaed registry.access.redhat.com/rhscl/nodejs-4-rhel7@sha256:b6fee5146e6330e9890f8290746944ab1452f709f806588fbfb1ff5cadb5aaedsha256:c17fa1ffa8e4acf5e66e10127aea2ae5ca3eda7c34aecc005aaf3b04da48814c 172.30.187.230:5000/mynodejs/nodejs-hello-world-v2@sha256:c17fa1ffa8e4acf5e66e10127aea2ae5ca3eda7c34aecc005aaf3b04da48814c">
    <meta itemprop="datePublished" content="2018-02-16T00:00:00-08:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Security and Vulnerability Scanning of Container Images
</h1>
          

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2018-02-16T00:00:00-08:00">February 16, 2018</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          23 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
        <h2><img class="alignnone  wp-image-12383" src="/assets/2018/02/photodune-3931978-security-concept-with-a-lock-xl-900x506.jpg" alt="security concept  with a lock" width="518" height="291" /></h2>
<h2><span style="text-decoration:underline;">Overview</span></h2>
<p>In this article we will focus on security and vulnerability strategies for scanning container images. I know, in the past security was always viewed upon as an impedance to the speed of production but hopefully these days are behind us. Having a security breach, as you probably know, is one of the most costly things an organization can endure. It takes years to build up a reputation and only seconds to tear it down completely.</p>
<p>I still see today, many organizations ignoring container images completely because it is often misunderstood. Exactly what is inside a container image? Who should be responsible for it? How does it map to what we have done on servers? Security teams often don't understand containers or even know what questions to ask. We need to help them and it is our duty to do so. Unfortunately there are not very many tools that can help in broad sense. Containers are new and evolving at breakneck speed. That coupled with the fact that security can negatively impact the speed of a DevOps team (if not done right), it is no wonder we are at square one, in many cases.</p>
<p>Before we dive into more detail, let us review important security aspects of containers.</p>
<ul>
<li>Containers can have various packaging formats, Docker is the most popular today</li>
<li>Containers are immutable and as such are image based</li>
<li>Container are never updated, any change always results in a new container</li>
<li>Container images consist of layers (base, runtime, application)</li>
<li>Container images require shared responsibility between dev and ops</li>
<li>Containers don't contain, they are in fact, just processes</li>
</ul>
<p>For more information I recommend reading about the <a href="https://www.redhat.com/cms/managed-files/cl-container-security-openshift-cloud-devops-tech-detail-f7530kc-201705-en.pdf">10 layers of container security</a>.</p>
<p><!--more--></p>
<p>Container images contain OS, runtime and application (everything but the Linux kernel basically). If a container is breached, there is not much in the way preventing further containers from being breached unless you have SELinux, limit kernel capabilities, run as non-priviledged user and follow many other best practices. OpenShift and using trusted, signed images by a vendor like Red Hat does all of this by default. Even still the attack surface can be large. You still think it is OK to not worry about container images and what is inside? Thankfully there are at least several solutions we will talk about from Red Hat for the container Platform OpenShift.</p>
<ul>
<li><strong>Container Catalog</strong> grades images provided by Red Hat and provides history of image as security patches are applied.</li>
<li><strong>Atomic CLI</strong> scans images and uses OpenSCAP to determine security vulnerabilities.</li>
<li><strong>CloudForms</strong> scans images using OpenSCAP (same as atomic) and also adds capabilities like taking action when container images are vulnerable, automatically scanning new images and even reporting.</li>
</ul>
<p>All of these solutions are included with OpenShift.</p>
<h2>Container Catalog</h2>
<p>Red Hat offers a container catalog for all images that it provides. Images are maintained by Red Hat meaning they are frequently scanned and updated. The container catalog also provides the history of an image, each time it is updated a new tag is created. The image is graded according to a scale A to F.</p>
<table class="tg" style="height:672px;" width="520">
<colgroup>
<col span="1" />
<col span="1" /></colgroup>
<tbody>
<tr>
<th class="tg-yw4l" width="20%">Health Index</th>
<th class="tg-yw4l" width="80%">Security Errata Conditions</th>
</tr>
<tr>
<td class="tg-yw4l"><strong>Grade A</strong></td>
<td class="tg-yw4l"> This image does not have any unapplied Critical or Important security errata</td>
</tr>
<tr>
<td class="tg-yw4l"><strong>Grade B</strong></td>
<td class="tg-yw4l"> This image is affected by Critical (no older than 7 days) or Important (no older than 30 days) security errata</td>
</tr>
<tr>
<td class="tg-yw4l"><strong>Grade C</strong></td>
<td class="tg-yw4l"> This image is affected by Critical (no older than 30 days) or Important (no older than 90 days) security errata</td>
</tr>
<tr>
<td class="tg-yw4l"><strong>Grade D</strong></td>
<td class="tg-yw4l"> This image is affected by Critical (no older than 90 days) or Important (no older than 12 months) security errata</td>
</tr>
<tr>
<td class="tg-yw4l"><strong>Grade E</strong></td>
<td class="tg-yw4l"> This image is affected by Critical or Important security errata no older than 12 months</td>
</tr>
<tr>
<td class="tg-yw4l"><strong>Grade F</strong></td>
<td class="tg-yw4l"> This image is affected by Critical or Important security errata older than 12 months</td>
</tr>
<tr>
<td class="tg-yw4l"><strong>Unknown</strong></td>
<td class="tg-yw4l">This image is missing metadata required to calculate a grade and cannot be scanned</td>
</tr>
</tbody>
</table>
<p><strong>Check image (example nodejs-6).</strong></p>
<p><a href="https://access.redhat.com/containers/?tab=overview&amp;platform=openshift#/registry.access.redhat.com/rhscl/nodejs-6-rhel7">https://access.redhat.com/containers/?tab=overview&amp;platform=openshift#/registry.access.redhat.com/rhscl/nodejs-6-rhel7</a></p>
<p><img class="alignnone  wp-image-12350" src="/assets/2018/02/cc_1.png" alt="cc_1" width="789" height="585" /></p>
<p>We see the image has a health index of A and is also signed. We also see it runs as unprivileged user.</p>
<p><strong>View Image History</strong></p>
<p>Under tags, the history of the image can be viewed.</p>
<p><img class="alignnone  wp-image-12351" src="/assets/2018/02/cc_2.png" alt="cc_2" width="828" height="611" /></p>
<p><strong>Image Details</strong></p>
<p>By clicking on the tag name we are able to get more detail about a given image.</p>
<p><img class="alignnone  wp-image-12352" src="/assets/2018/02/cc_3.png" alt="cc_3" width="755" height="493" /></p>
<p>Any CVEs that affect the image are shown in addition to RPM advisory.</p>
<h2>Atomic CLI Image Scanning</h2>
<p>Atomic Cli provides image scanning using OpenSCAP. This tool can be used via Ansible or other automation in CI/CD pipeline to automatically scan images.</p>
<p><strong>Install Atomic cli</strong></p>
<p>If you aren't running RHEL Atomic you need to install the atomic cli. In this case we are doing so on the OpenShift master (master0) but it can be any node that has access to the container images. If image doesn't exist locally (in this case on master0) it must be pulled down.</p>
<pre>[master0 ~]$ yum install -y atomic</pre>
<p><strong>Get the image that should be scanned</strong></p>
<pre>[master0 ~]$ oc get image |grep nodejs
sha256:947bf778fd9ee31a4cd06a702954aa0cd91e1eb81fef366a9080c0cfe3e35e43 172.30.187.230:5000/mynodejs/test@sha256:947bf778fd9ee31a4cd06a702954aa0cd91e1eb81fef366a9080c0cfe3e35e43
<strong>sha256:a9b89bb53fef405ea73f3eaff2dafa0c37c2cc988586b1a8a0e3bc19de07d4b8</strong> <strong>registry.access.redhat.com/rhscl/nodejs-6-rhel7@sha256:a9b89bb53fef405ea73f3eaff2dafa0c37c2cc988586b1a8a0e3bc19de07d4b8</strong>
sha256:b6fee5146e6330e9890f8290746944ab1452f709f806588fbfb1ff5cadb5aaed registry.access.redhat.com/rhscl/nodejs-4-rhel7@sha256:b6fee5146e6330e9890f8290746944ab1452f709f806588fbfb1ff5cadb5aaed
sha256:c17fa1ffa8e4acf5e66e10127aea2ae5ca3eda7c34aecc005aaf3b04da48814c 172.30.187.230:5000/mynodejs/nodejs-hello-world-v2@sha256:c17fa1ffa8e4acf5e66e10127aea2ae5ca3eda7c34aecc005aaf3b04da48814c

</pre>
<p><strong>Scan image.</strong></p>
<p>Ensure openscap image is installed.</p>
<pre>[master0 ~]$ sudo atomic install registry.access.redhat.com/rhel7/openscap</pre>
<p>Using the image location we perform a scan.</p>
<pre>[master0 ~]$ sudo atomic scan registry.access.redhat.com/rhscl/nodejs-6-rhel7@sha256:a9b89bb53fef405ea73f3eaff2dafa0c37c2cc988586b1a8a0e3bc19de07d4b8

registry.access.redhat.com/rhscl/nodejs-6-rhel7@sha256:a9b89bb53fef405ea73f3eaff2dafa0c37c2cc988586b1a8a0e3bc19de07d4b8 (ae9be2ffb565659)

The following issues were found:

RHSA-2018:0260: systemd security update (Moderate)
 Severity: Moderate
 RHSA URL: https://access.redhat.com/errata/RHSA-2018:0260
 RHSA ID: RHSA-2018:0260-01
 Associated CVEs:
 CVE ID: CVE-2018-1049
 CVE URL: https://access.redhat.com/security/cve/CVE-2018-1049

RHSA-2018:0180: kernel-alt security and bug fix update (Important)
 Severity: Important
 RHSA URL: https://access.redhat.com/errata/RHSA-2018:0180
 RHSA ID: RHSA-2018:0180-01
 Associated CVEs:
 CVE ID: CVE-2017-1000405
 CVE URL: https://access.redhat.com/security/cve/CVE-2017-1000405

RHSA-2017:0372: kernel-aarch64 security and bug fix update (Important)
 Severity: Important
 RHSA URL: https://access.redhat.com/errata/RHSA-2017:0372
 RHSA ID: RHSA-2017:0372-01
 Associated CVEs:
 CVE ID: CVE-2016-5195
 CVE URL: https://access.redhat.com/security/cve/CVE-2016-5195
 CVE ID: CVE-2016-7039
 CVE URL: https://access.redhat.com/security/cve/CVE-2016-7039
 CVE ID: CVE-2016-8666
 CVE URL: https://access.redhat.com/security/cve/CVE-2016-8666</pre>
<p>Here we notice several important or high severity CVEs and a medium.</p>
<p>Using atomic cli may be enough if images going into registry are tightly controlled. This could work well if additional tooling such as Artifactory is used to persist container images. They can easily be scanned before being added to Artifactory as part of CI/CD process.</p>
<h2>CloudForms Image Scanning</h2>
<p>CloudForms provides additional capabilities for security and vulnerability scanning. You can configure policies to take action based on an vulnerable image. For example, not allowing vulnerable images to run or notifying security team. In addition, as soon as an image is created and pushed to OpenShift registry via CI/CD, it can be scanned. Reporting allows for understanding impact of vulnerable images across projects in OpenShift. Image users can be easily notified and it allows roles between development and operations to have clear delineation.</p>
<h3>Configure CloudForms Provider for OpenShift</h3>
<p>The first step is to configure CloudForms provider to access OpenShift environment.</p>
<p><strong>Get management-admin token for management-infra project.</strong></p>
<pre>[master0 ~]$ oc get sa management-admin -o yaml -n management-infra
apiVersion: v1
imagePullSecrets:
- name: management-admin-dockercfg-4dfcr
kind: ServiceAccount
metadata:
 creationTimestamp: 2018-02-09T21:01:32Z
 name: management-admin
 namespace: management-infra
 resourceVersion: "1092"
 selfLink: /api/v1/namespaces/management-infra/serviceaccounts/management-admin
 uid: 6860deab-0ddc-11e8-ab6a-fa163e0b5deb
secrets:
- name: <strong>management-admin-token-q9clk</strong>
- name: management-admin-dockercfg-4dfcr</pre>
<p><strong>Get Secret for management-admin token.</strong></p>
<pre>[master0 ~]$ oc describe secret management-admin-token-q9clk -n management-infra
Name: management-admin-token-q9clk
Namespace: management-infra
Labels: 
Annotations: kubernetes.io/service-account.name=management-admin
 kubernetes.io/service-account.uid=6860deab-0ddc-11e8-ab6a-fa163e0b5deb

Type: kubernetes.io/service-account-token

Data
====
token: <strong>eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJtYW5hZ2VtZW50LWluZnJhIiwia3ViZXJuZXRlcy32ay9zZXJ2aWNlYWNjb3VudC9zZWNyZXQubmFtZSI6Im1hbmFnZW1lbnQtYWRtaW4tdG9rZW4tcTljbGsiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYW55ddssaVudC5uYW1lIjoibWFuYWdlbWVudC1hZG1pbiIsImt1YmVybmV0ZXMuaW</strong>
ca.crt: 1070 bytes
namespace: 16 bytes
service-ca.crt: 2186 bytes</pre>
<p><strong>Add OpenShift Provider to CloudForms.</strong></p>
<p>OpenShift by default creates a management-infra project with a management-admin SA and token. This project is used by CloudForms for access and image scanning.</p>
<p><img class="alignnone  wp-image-12325" src="/assets/2018/02/cfme_sec_1.png" alt="cfme_sec_1" width="768" height="531" /></p>
<p><img class="alignnone  wp-image-12327" src="/assets/2018/02/cfme_sec_2.png" alt="cfme_sec_2" width="784" height="461" /></p>
<p><strong>Set Node Selector for management-infra project.</strong></p>
<p>In this example we will set the region to infra. This means any nodes with region infra will run image scanning container. Infra nodes also generally run other shared platform services like router, registry, metrics and logging.</p>
<pre>[master0 ~]$ oc edit namespace management-infra
---
metadata:
 annotations:
   openshift.io/node-selector: region=infra
---</pre>
<h3>Configure Security Scanning Policies</h3>
<p>CloudForms ships with compliance and control policies that will automatically scan containers. If vulnerabilities are detected, containers with those vulnerabilities will be prevented from running. This is not enabled by default but I find it a bit aggressive and recommend scanning images and reporting them as non-compliant instead.</p>
<p>Login to CloudForms and navigate to control-&gt;explorer.</p>
<p><strong>Copy OpenScap Compliance Policy.</strong></p>
<p><img class="alignnone  wp-image-12328" src="/assets/2018/02/cfme_policy_1.png" alt="cfme_policy_1" width="767" height="578" /></p>
<p><strong>Edit the copied OpenScap compliance policy.</strong></p>
<p>Here we will remove the action to prevent container images that are non-compliant from running.</p>
<p><img class="alignnone  wp-image-12329" src="/assets/2018/02/cfme_policy_2.png" alt="cfme_policy_2" width="1158" height="388" /></p>
<p><strong>Add new container image condition for sti builder.</strong></p>
<p><img class="alignnone  wp-image-12332" src="/assets/2018/02/cfme_policy_5.png" alt="cfme_policy_5" width="948" height="896" /></p>
<p>Under conditions accordion, create a new condition. We will want to ignore scanning the sti builder.</p>
<p><img class="alignnone  wp-image-12330" src="/assets/2018/02/cfme_policy_3.png" alt="cfme_policy_3" width="880" height="658" /></p>
<p><strong>Add new container image condition for deployer.</strong></p>
<p>Under conditions accordion, create a new condition. We will want to ignore scanning the deployer.</p>
<p><img class="alignnone  wp-image-12331" src="/assets/2018/02/cfme_policy_4.png" alt="cfme_policy_4" width="821" height="547" /></p>
<p><strong>Copy control policy Analyse incoming container images and edit condition assignments.</strong></p>
<p>Add the two newly created conditions.</p>
<p><img class="alignnone  wp-image-12333" src="/assets/2018/02/cfme_policy_6.png" alt="cfme_policy_6" width="1342" height="387" /></p>
<p><strong>Add new profile policy.</strong></p>
<p>Under "all profile policies", add a new profile policy. Add the following policies:</p>
<ul>
<li>Copy of OpenScap (compliance)</li>
<li>Copy of Analyze incoming container images (control)</li>
<li>Schedule compliance after smart state analysis (control)</li>
</ul>
<p><img class="alignnone  wp-image-12334" src="/assets/2018/02/cfme_policy_7.png" alt="cfme_policy_7" width="1407" height="422" /></p>
<p><strong>Enable policy profile on OpenShift provider.</strong></p>
<p>Navigate to Compute-&gt;Containers-&gt;Providers.</p>
<p><img class="alignnone  wp-image-12335" src="/assets/2018/02/cfme_policy_8.png" alt="cfme_policy_8" width="725" height="735" /></p>
<p>Our policy profile will ensure the following:</p>
<ul>
<li>All images that change are scanned immediately</li>
<li>The deployer, STI builder and image inspector are ignored</li>
<li>Images with High vulnerability are marked as non-compliant</li>
</ul>
<h3>Perform Container Image Scanning</h3>
<p>Each build creates a new image. As soon as build is pushed the image is automatically scanned. In this case a change was made which kicked off CI/CD, resulting in a build and a new image being pushed to registry.</p>
<p><img class="alignnone  wp-image-12337" src="/assets/2018/02/ose_nodejs_1.png" alt="ose_nodejs_1" width="1265" height="424" /></p>
<p><img class="alignnone  wp-image-12338" src="/assets/2018/02/ose_nodejs_21.png" alt="ose_nodejs_2" width="2242" height="346" /></p>
<p><strong>Check pods under management-infra project.</strong></p>
<p>Each image will trigger a scan. The image scanner container will mount the image and scan it using openscap.</p>
<pre>[master0 ~]$ oc get pods -o wide -n management-infra
NAME READY STATUS RESTARTS AGE IP NODE
manageiq-img-scan-ea955 0/1 Running 0 2m 10.30.1.54 infra0</pre>
<p><strong>Check image scanner container logs.</strong></p>
<pre>[master0 ~]$ oc logs manageiq-img-scan-ea955 -n management-infra
2018/02/15 16:26:56 Pulling image 172.30.187.230:5000/mynodejs/nodejs-hello-world-v2@sha256:e5dba582855f9de07d9a00b2f2d0986b41d229112626593a4a6ba50ff53bbf49
2018/02/15 16:26:56 Authentication with Default Empty Authentication failed: unauthorized: authentication required
2018/02/15 16:27:07 Downloading Image (17Kb downloaded)
2018/02/15 16:27:09 Finished Downloading Image (17Kb downloaded)
<strong>2018/02/15 16:27:24 Extracting image 172.30.187.230:5000/mynodejs/nodejs-hello-world-v2@sha256:e5dba582855f9de07d9a00b2f2d0986b41d229112626593a4a6ba50ff53bbf49 to /var/tmp/image-inspector-545571508</strong>
2018/02/15 16:32:49 OpenSCAP scanning /var/tmp/image-inspector-545571508. Placing results in /var/tmp/image-inspector-scan-results-428093571
2018/02/15 16:33:43 Serving image content /var/tmp/image-inspector-545571508 on webdav://0.0.0.0:8080/api/v1/content/</pre>
<p><strong>Find image.</strong></p>
<p>Once the image scanner runs we can navigate to the image in CloudForms under Compute-&gt;Containers-&gt;Container Images. We can use the search field to filter and find image by it's name. In this case it is of course the latest image.</p>
<p><img class="alignnone  wp-image-12339" src="/assets/2018/02/cfme_image_1.png" alt="cfme_image_1" width="1325" height="542" /></p>
<p><strong>View Image Details.</strong></p>
<p>Here we can see that smart state analysis in CloudForms (container image scan) was run. Notice compliance is not-compliant. Two High severity and a medium severity rule failed. This is exactly what we also saw when running atomic image scan. Finally notice in addition to the OpenScap results, we also have inventory of all the packages and corresponding package versions, installed in the image.</p>
<p><img class="alignnone  wp-image-12340" src="/assets/2018/02/cfme_image_2.png" alt="cfme_image_2" width="1094" height="515" /></p>
<h3>Container Security and Vulnerability Reporting</h3>
<p>Now that we are able to scan images and flag ones that have high security vulnerabilities, it is time to look into reporting. You could easily have 1000s of images so reporting becomes increasingly important to identify projects using high vulnerability images. This allows us to nicely segregate roles and responsibilities. The platform team can scan images and notify devops teams about vulnerabilities, who can in turn fix them. There are of course other models, just an idea.</p>
<p><strong>Create Container Image Vulnerability Report.</strong></p>
<p>Under CloudIntel-&gt;Reports-&gt;Custom add a new report.</p>
<p><strong>Select Fields.</strong></p>
<p><img class="alignnone  wp-image-12356" src="/assets/2018/02/cfme_report_10.png" alt="cfme_report_10" width="968" height="642" /></p>
<p><strong>Configure Filters.</strong></p>
<p>There are two types of filters: primary and secondary. Primary is used when doing select on database while secondary filters after records are returned from database. Primary filter we will set to last compliance failed. This will find only images that failed compliance check, in this case ones that have a high severity vulnerability. Secondary filter we will set to display only rules that have failed, are high severity and only in projects that have images.</p>
<p><img class="alignnone  wp-image-12357" src="/assets/2018/02/cfme_report_11.png" alt="cfme_report_11" width="1146" height="546" /></p>
<p><strong>Run Report.</strong></p>
<p>Under Reports-&gt;Custom select the report "OpenScap High Security Vulnerabilities" and select queue from configuration dropdown. The report will show projects that have images with a high severity rule that failed.</p>
<p><img class="alignnone  wp-image-12359" src="/assets/2018/02/cfme_report_12.png" alt="cfme_report_12" width="1807" height="494" /></p>
<p>Once projects and images are identified more detail may be obtained by looking at the OpenScap report. Under Compute-&gt;Containers-&gt;Container Images you can find the image and open it for more details. The OpenScap html report will contain details on specific rules and security violations.</p>
<p><img class="alignnone size-full wp-image-12346" src="/assets/2018/02/cfme_report_6.png" alt="cfme_report_6" width="814" height="171" /></p>
<p>Clicking the OpenScap HTML report will download it via browser. The report shows all rules and if they passed or failed.</p>
<p><img class="alignnone  wp-image-12347" src="/assets/2018/02/cfme_report_7.png" alt="cfme_report_7" width="1190" height="119" /></p>
<p>You can dril into the rule and get more information. The summary shows the relevant CVEs.</p>
<p><img class="alignnone  wp-image-12348" src="/assets/2018/02/cfme_report_9.png" alt="cfme_report_9" width="1605" height="439" /></p>
<p>Violations that caused the rule to fail are also shown.</p>
<p><img class="alignnone  wp-image-12349" src="/assets/2018/02/cfme_report_8.png" alt="cfme_report_8" width="2204" height="295" /></p>
<h2>Scanning Applications Inside Container Images</h2>
<p>Until now we have been focused on mainly scanning the base OS image every container is built on. It is also possible and there are tools to allow scanning of layers above the base OS.  Red Hat provides pluggable API in Red Hat Enterprise Linux to support multiple scanners such as OpenSCAP, Aqua Security, Black Duck Hub, JFrog Xray and Twistlock. Red Hat OpenShift gives you the ability to use scanners with continuous integration and delivery (CI/CD) tools.</p>
<p>A best practice for application security is to integrate automated security testing directly into build or CI/CD tooling.</p>
<ul>
<li>Integrate with Static Application Security Testing (SAST) and Dynamic Application Security Testing (DAST) tools like HP Fortify and IBM AppScan.</li>
<li>Add Scanners for real-time checking against known vulnerabilities like Aqua Security, Black Duck, JFrog and Twistlock. Tools like these catalog open source packages in your container, notify you of any known vulnerabilities and update when new vulnerabilities are discovered in previously scanned packages.</li>
<li>CI/CD process should include policies that automatically open issues when security vulnerabilities are discovered in the build process so the devops team can take immediate action to resolve problems.</li>
</ul>
<p>Finally there is an effort underway by Red Hat, Google and others to <a href="https://www.redhat.com/en/blog/red-hat-google-cloud-and-other-industry-leaders-join-together-standardize-kubernetes-service-component-auditing-and-policy-enforcement">standardize auditing and policy enforcement with Kubernetes.</a></p>
<h2>Summary</h2>
<p>In this article we looked into the topic of security and vulnerability scanning of container images. Unfortunately this is a topic that doesn't get nearly enough attention in my view. We discussed the importance of why you want to keep container images updated, signed and get them from only trusted sources. We looked into several solutions provided by Red Hat. The Container Catalog, Atomic Cli and CloudForms. A guide was provided to explore each of these solutions individually, not only to understand their value, but also how to use them. In the end I think all three tools provide valuable information to ensure security standards are upheld. Choosing one of them or all of them depends on the processes an organization has defined.</p>
<p>Happy Secure Containers!</p>
<p>(c) 2018 Keith Tenzer</p>

        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/#containers" class="page__taxonomy-item" rel="tag">Containers</a><span class="sep">, </span>
    
      <a href="/tags/#openshift" class="page__taxonomy-item" rel="tag">OpenShift</a><span class="sep">, </span>
    
      <a href="/tags/#security" class="page__taxonomy-item" rel="tag">Security</a>
    
    </span>
  </p>




  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      <a href="/categories/#cloudforms" class="page__taxonomy-item" rel="tag">CloudForms</a>
    
    </span>
  </p>


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2018-02-16T00:00:00-08:00">February 16, 2018</time></p>


      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?via=keithtenzer&text=Security+and+Vulnerability+Scanning+of+Container+Images%20https%3A%2F%2Fkeithtenzer.com%2Fcloudforms%2Fsecurity-and-vulnerability-scanning-of-container-images%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fkeithtenzer.com%2Fcloudforms%2Fsecurity-and-vulnerability-scanning-of-container-images%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fkeithtenzer.com%2Fcloudforms%2Fsecurity-and-vulnerability-scanning-of-container-images%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/openstack/openstack-12-pike-lab-installation-and-configuration-guide-with-hetzner-root-servers/" class="pagination--pager" title="OpenStack 12 (Pike) Lab Installation and Configuration Guide with Hetzner Root Servers
">Previous</a>
    
    
      <a href="/openshift/openshift-on-openstack-1-2-3-bringing-iaas-and-paas-together/" class="pagination--pager" title="OpenShift on OpenStack 1-2-3: Bringing IaaS and PaaS Together
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You may also enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/openshift/openshift-service-mesh-getting-started-guide/" rel="permalink">OpenShift Service Mesh Getting Started Guide
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2021-04-27T00:00:00-07:00">April 27, 2021</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          11 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">






Overview
In this article we will explore the OpenShift Service Mesh and deploy a demo application to better understand the various concepts. First you...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/openshift/openshift-4-aws-ipi-installation-getting-started-guide/" rel="permalink">OpenShift 4 AWS IPI Installation Getting Started Guide
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2021-01-18T00:00:00-08:00">January 18, 2021</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          8 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">


Happy new year as this will be the first post of 2021! 2020 was obviously a challenging year, my hope is I will have more time to devote to blogging in 20...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/ansible/windows-automation-with-ansible-getting-started-guide/" rel="permalink">Windows Automation with Ansible: Getting Started Guide
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2020-05-19T00:00:00-07:00">May 19, 2020</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          14 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
Overview
In this article we will focus on how to get started with automation of windows using Ansible. Specifically we will look at installing 3rd party sof...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/general/red-hat-subscription-reporting-guide/" rel="permalink">Red Hat Subscription Reporting Guide
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2020-05-13T00:00:00-07:00">May 13, 2020</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          6 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
source: https://www.cio.com/article/3199910/zuora-blazes-a-new-trail-to-the-subscription-economy-and-a-post-erp-world.html
Overview
This article will look a...</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
          <li><a href="https://twitter.com/keithtenzer"" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
        
      
        
      
        
          <li><a href="https://github.com/ktenzer" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
      
        
      
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2021 Keith Tenzer. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>







  </body>
</html>
